# ğŸ“Š BluedonuLab - ë°ì´í„° í™œìš© ì „ëµ & êµ¬í˜„ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [ë°ì´í„° ì†ŒìŠ¤ & êµ¬ì¡°](#ë°ì´í„°-ì†ŒìŠ¤--êµ¬ì¡°)
2. [ì„±í–¥ í…ŒìŠ¤íŠ¸ ë°ì´í„° í™œìš©](#ì„±í–¥-í…ŒìŠ¤íŠ¸-ë°ì´í„°-í™œìš©)
3. [ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ ë°ì´í„° íë¦„](#ë§¤ì¹­-ì•Œê³ ë¦¬ì¦˜-ë°ì´í„°-íë¦„)
4. [UIë³„ ë°ì´í„° ì¿¼ë¦¬ & ì—°ë™](#uië³„-ë°ì´í„°-ì¿¼ë¦¬--ì—°ë™)
5. [ë°ì´í„° ì „ì²˜ë¦¬ & ì •ê·œí™”](#ë°ì´í„°-ì „ì²˜ë¦¬--ì •ê·œí™”)
6. [AI í†µí•© í™œìš©](#ai-í†µí•©-í™œìš©)
7. [ì„±ê³¼ ì§€í‘œ & ëª¨ë‹ˆí„°ë§](#ì„±ê³¼-ì§€í‘œ--ëª¨ë‹ˆí„°ë§)

---

## ë°ì´í„° ì†ŒìŠ¤ & êµ¬ì¡°

### ğŸ“ ë°ì´í„° íŒŒì¼ ìœ„ì¹˜ (í•„ìˆ˜ í™•ì¸)

> **âš ï¸ ì¤‘ìš”**: ë‹¤ìŒ íŒŒì¼ë“¤ì´ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
> ê²½ë¡œ: `/Users/sangwon/Project/Sesac_class/bluedonulab-01/`

```
í”„ë¡œì íŠ¸ ë£¨íŠ¸/
â”œâ”€â”€ Residents.csv                         â­â­â­ í•„ìˆ˜
â”œâ”€â”€ staff.csv                             â­â­â­ í•„ìˆ˜
â”œâ”€â”€ medications.csv                       â­â­ í•„ìˆ˜
â”œâ”€â”€ healthcare_dataset.csv                â­â­ ê¶Œì¥
â”œâ”€â”€ HomeHealthCare-StatebyStateData.csv   â­â­ ê¶Œì¥
â””â”€â”€ (ì´ì „ CAREHOME/ í´ë”ëŠ” ì œê±°ë¨)
```

**íŒŒì¼ í¬ê¸° ê°€ì´ë“œ**:
- `Residents.csv`: ~500KB (1,000 í–‰ + 8ê°œ ì—´)
- `staff.csv`: ~400KB (1,000 í–‰ + 6ê°œ ì—´)
- `medications.csv`: ~800KB (2,000 í–‰ + 5ê°œ ì—´)
- `healthcare_dataset.csv`: ~25MB (50,000+ í–‰)
- `HomeHealthCare-StatebyStateData.csv`: ~200KB (50 í–‰ Ã— 25ê°œ ì—´)

---

### ğŸ“š ë³´ìœ  ë°ì´í„°ì…‹ í˜„í™©

> **ğŸ’¡ ì£¼ì„**: BluedonuLab í”„ë¡œì íŠ¸ì—ì„œ ë³´ìœ í•œ 5ê°€ì§€ ë°ì´í„°ì…‹ì„ ìš°ì„ ìˆœìœ„ ìˆœì„œë¡œ ì •ë ¬í–ˆìŠµë‹ˆë‹¤.
> - CAREHOMEì€ ì‹¤ì œ ìš´ì˜ ë°ì´í„°ì´ë¯€ë¡œ ìµœìš°ì„  (â­â­â­)
> - Healthcare & Home Health CareëŠ” ë²¤ì¹˜ë§ˆí‚¹ê³¼ í™•ì¥ì„±ì„ ìœ„í•œ ë³´ì¡° ë°ì´í„° (â­â­)

| ë°ì´í„°ì…‹ | íŒŒì¼ëª… | ê·œëª¨ | ìš©ë„ | ìš°ì„ ìˆœìœ„ |
|---------|--------|------|------|---------|
| **CAREHOME** (Residents) | `Residents.csv` | 1,000ëª… | í™˜ì í”„ë¡œí•„, ì„±í–¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì €ì¥ | â­â­â­ |
| **CAREHOME** (Staff) | `staff.csv` | 1,000ëª… | ê°„ë³‘ì¸ í”„ë¡œí•„, ëŒë´„ ìŠ¤íƒ€ì¼ ë¶„ì„ | â­â­â­ |
| **CAREHOME** (Medications) | `medications.csv` | 2,000ê°œ | ì•½ë¬¼ ë³µì¡ë„ ì ìˆ˜ ê³„ì‚° | â­â­ |
| **Healthcare Dataset** | `healthcare_dataset.csv` | 50,000+ | ì˜ë£Œ ìƒíƒœë³„ í™˜ì í”„ë¡œí•„ í™•ì¥ | â­â­ |
| **Home Health Care KPI** | `HomeHealthCare-StatebyStateData.csv` | 50ì£¼(ë¯¸êµ­) | ì§€ì—­ë³„ ì„±ê³¼ ë²¤ì¹˜ë§ˆí¬ | â­â­ |

### ğŸ—„ï¸ í†µí•© ë°ì´í„° ì•„í‚¤í…ì²˜

> **ğŸ’¡ ì£¼ì„**:
> ì´ ë‹¤ì´ì–´ê·¸ë¨ì€ BluedonuLabì˜ **ë°ì´í„° ìƒëª…ì£¼ê¸°**ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
>
> **ì›ë³¸ ë°ì´í„° (Raw Data)** ë‹¨ê³„:
> - 3ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì†ŒìŠ¤(CAREHOME, Healthcare, Home Health Care)ì—ì„œ ë°ì´í„° ìˆ˜ì§‘
> - ê° ë°ì´í„°ì…‹ì˜ í˜•ì‹, ë²”ìœ„, í’ˆì§ˆì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ
>
> **ETL (Extract, Transform, Load)** ë‹¨ê³„:
> - ì›ë³¸ ë°ì´í„°ì˜ ë¶ˆì™„ì „í•¨ì„ ì •ì œ (ê²°ì¸¡ì¹˜, ì´ìƒì¹˜)
> - ê° ë°ì´í„°ì…‹ì˜ í˜•ì‹ì„ í†µì¼ (íƒ€ì… ë³€í™˜)
> - ìˆ˜ì¹˜ ë°ì´í„°ë¥¼ 0~100 ë²”ìœ„ë¡œ ì •ê·œí™” (ì„±í–¥ ì ìˆ˜ ê³„ì‚°)
> - ì´ ê³¼ì •ì—ì„œ "ë”í‹° ë°ì´í„°"ê°€ "í´ë¦° ë°ì´í„°"ë¡œ ë³€í™˜ë¨
>
> **ì• í”Œë¦¬ì¼€ì´ì…˜ ë°ì´í„°ë² ì´ìŠ¤** ë‹¨ê³„:
> - ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•  í…Œì´ë¸”ë“¤
> - ì„±í–¥, ìŠ¤íƒ€ì¼, ë§¤ì¹­ ê²°ê³¼ ë“±ì´ ì €ì¥ë˜ëŠ” ê³³
> - UI/APIê°€ ì§ì ‘ ì¿¼ë¦¬í•˜ëŠ” ì†ŒìŠ¤
>
> **UI/API ì†Œë¹„** ë‹¨ê³„:
> - í”„ë¡ íŠ¸ì—”ë“œ í™”ë©´ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë¥¼ APIì—ì„œ ì¡°íšŒ
> - ê° í™”ë©´ë§ˆë‹¤ í•„ìš”í•œ í…Œì´ë¸”ì´ ë‹¤ë¦„ (ì˜ˆ: ì„±í–¥ í…ŒìŠ¤íŠ¸ëŠ” PatientPersonalityë§Œ í•„ìš”)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ì›ë³¸ ë°ì´í„° (Raw Data)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CAREHOME         Healthcare         Home Health Care        â”‚
â”‚ â”œâ”€ Residents     â”œâ”€ Patient Info    â””â”€ State KPIs         â”‚
â”‚ â”œâ”€ Staff         â””â”€ Medical          (50ê°œ ì§€í‘œ)           â”‚
â”‚ â””â”€ Medications      Conditions                             â”‚
â”‚                                                              â”‚
â”‚ ìƒíƒœ: CSV íŒŒì¼ ë˜ëŠ” ì™¸ë¶€ DBì—ì„œ ë¶ˆê·œì¹™í•œ í˜•ì‹ìœ¼ë¡œ ì¡´ì¬       â”‚
â”‚ ë¬¸ì œì : ê²°ì¸¡ì¹˜ ìˆìŒ, íƒ€ì… ë¶ˆì¼ì¹˜, ì´ìƒì¹˜ í¬í•¨              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ë°ì´í„° í†µí•© & ì „ì²˜ë¦¬ (ETL)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ (Medications.Dosage 3%)                      â”‚
â”‚    â†’ ê° ì•½ë¬¼ë³„ ì¤‘ì•™ê°’(Median)ìœ¼ë¡œ ìë™ ì±„ìš°ê¸°               â”‚
â”‚                                                              â”‚
â”‚ 2. ë°ì´í„° íƒ€ì… ë³€í™˜ (Date, Categorical)                     â”‚
â”‚    â†’ ë¬¸ì ë‚ ì§œë¥¼ DateTime ê°ì²´ë¡œ, ì„±ë³„ì„ Enumìœ¼ë¡œ          â”‚
â”‚                                                              â”‚
â”‚ 3. ì´ìƒì¹˜ íƒì§€ ë° ì œê±°                                       â”‚
â”‚    â†’ IQR(Interquartile Range) ë°©ì‹ìœ¼ë¡œ ë¹„ì •ìƒ ê°’ ì œê±°      â”‚
â”‚    â†’ ì˜ˆ: ë‚˜ì´ 200ì„¸ ì´ìƒ ì œê±°                              â”‚
â”‚                                                              â”‚
â”‚ 4. ì •ê·œí™” & í‘œì¤€í™” (Min-Max, Z-score)                      â”‚
â”‚    â†’ ëª¨ë“  ìˆ˜ì¹˜ë¥¼ 0~100 ë²”ìœ„ë¡œ í†µì¼                          â”‚
â”‚    â†’ ê³µê°ë„, í™œë™ì„± ë“±ì„ ë¹„êµ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ë³€í™˜            â”‚
â”‚                                                              â”‚
â”‚ 5. ì„±í–¥ ì ìˆ˜ ê³„ì‚° ì—”ì§„                                       â”‚
â”‚    â†’ 12ê°œ í…ŒìŠ¤íŠ¸ ë¬¸í•­ì˜ ë‹µë³€ì„ 4ê°œ ì¶• ì ìˆ˜ë¡œ ê³„ì‚°           â”‚
â”‚    â†’ ê° í™˜ì/ê°„ë³‘ì¸ì˜ ê°œì„±ì„ ìˆ˜ì¹˜í™”                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ì²˜ë¦¬ëœ ë°ì´í„° (Application Database)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PatientPersonality        - í™˜ì ì„±í–¥ (4ê°œ ì¶•)              â”‚
â”‚   â†³ í™˜ì ID, Empathy(ê³µê°), Activity(í™œë™ì„±),               â”‚
â”‚     Patience(ì¸ë‚´ì‹¬ í•„ìš”), Independence(ë…ë¦½ì„±)             â”‚
â”‚                                                              â”‚
â”‚ CaregiverStyle            - ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ (4ê°œ ì¶•)          â”‚
â”‚   â†³ ê°„ë³‘ì¸ ID, ê°™ì€ 4ê°œ ì¶• ì ìˆ˜                             â”‚
â”‚   â†³ ë¦¬ë·°/ìê¸°ì†Œê°œ/ì¼€ì–´ë¡œê·¸ì—ì„œ ìë™ ê³„ì‚°ë¨                  â”‚
â”‚                                                              â”‚
â”‚ PersonalityBasedMatching  - ë§¤ì¹­ ê²°ê³¼ & ì ìˆ˜               â”‚
â”‚   â†³ í™˜ì-ê°„ë³‘ì¸ ë§¤ì¹­, í˜¸í™˜ë„ ì ìˆ˜, ë§Œì¡±ë„                  â”‚
â”‚   â†³ ì‹¤ì œ ë§¤ì¹­ ê¸°ë¡ ì €ì¥                                     â”‚
â”‚                                                              â”‚
â”‚ PersonalityBasedCandidates - ì¶”ì²œ í›„ë³´ (AI ë¶„ì„)           â”‚
â”‚   â†³ ê° í™˜ìì—ê²Œ ì¶”ì²œë˜ëŠ” ê°„ë³‘ì¸ ìƒìœ„ 10ëª…                   â”‚
â”‚   â†³ AIê°€ ìƒì„±í•œ ì¶”ì²œ ì´ìœ  í…ìŠ¤íŠ¸ í¬í•¨                       â”‚
â”‚                                                              â”‚
â”‚ DailyCareLog              - ì¼ì¼ ì¼€ì–´ ê¸°ë¡                 â”‚
â”‚   â†³ ê°„ë³‘ì¸ì´ ì…ë ¥í•œ ì¼ì¼ í™œë™ ê¸°ë¡                          â”‚
â”‚   â†³ ì‹ì‚¬ëŸ‰, ì•½ë¬¼ ë³µìš©, í™œë™, ê¸°ë¶„ ë“±                       â”‚
â”‚                                                              â”‚
â”‚ IoTMetrics                - IoT ì„¼ì„œ ë°ì´í„°                 â”‚
â”‚   â†³ ì›¨ì–´ëŸ¬ë¸” ê¸°ê¸°ì—ì„œ ìˆ˜ì§‘í•œ ì²´ì˜¨, ì‹¬ë°•ìˆ˜, í˜ˆì••             â”‚
â”‚   â†³ ì‹œê³„ì—´ ë°ì´í„° (ì‹œê°„ë³„ë¡œ ê¸°ë¡ë¨)                        â”‚
â”‚                                                              â”‚
â”‚ ìƒíƒœ: ì •ì œë˜ê³  ì •ê·œí™”ëœ í”„ë¡œë•ì…˜ ë°ì´í„°                      â”‚
â”‚ íŠ¹ì§•: ì™„ì „í•˜ê³ , ì¼ê´€ì„± ìˆê³ , ê²€ìƒ‰ ìµœì í™”ë¨                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               UI/APIì—ì„œ ì†Œë¹„ (Consumption)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ì„±í–¥ í…ŒìŠ¤íŠ¸ â†’ PatientPersonality                         â”‚
â”‚    í™”ë©´: "ë‚˜ì˜ ì„±í–¥ ê²°ê³¼" ë ˆì´ë” ì°¨íŠ¸                       â”‚
â”‚    í•„ìš” ë°ì´í„°: EmpathyScore, ActivityScore ë“±              â”‚
â”‚                                                              â”‚
â”‚ 2. ê°„ë³‘ì¸ íƒìƒ‰ â†’ PersonalityBasedCandidates                â”‚
â”‚    í™”ë©´: "ì¶”ì²œ ê°„ë³‘ì¸ ë¦¬ìŠ¤íŠ¸" ì¹´ë“œ ë¦¬ìŠ¤íŠ¸                   â”‚
â”‚    í•„ìš” ë°ì´í„°: í˜¸í™˜ë„ ì ìˆ˜, AI ì¶”ì²œ ì´ìœ                   â”‚
â”‚                                                              â”‚
â”‚ 3. ìƒì„¸ í”„ë¡œí•„ â†’ Caregivers + CaregiverStyle               â”‚
â”‚    í™”ë©´: "ê°„ë³‘ì¸ ìƒì„¸ ì •ë³´" ì‚¬ì´ë“œë°” í‘œì‹œ                   â”‚
â”‚    í•„ìš” ë°ì´í„°: í”„ë¡œí•„, ê²½ë ¥, ìŠ¤íƒ€ì¼ ì ìˆ˜                   â”‚
â”‚                                                              â”‚
â”‚ 4. ë¦¬í¬íŠ¸ ìƒì„± â†’ DailyCareLog + IoTMetrics                 â”‚
â”‚    í™”ë©´: "ì¼ì¼ ë¦¬í¬íŠ¸ íŒì—…" ê°€ì¡±ìš© ìš”ì•½                     â”‚
â”‚    í•„ìš” ë°ì´í„°: ì¼€ì–´ ê¸°ë¡, ê±´ê°• ì§€í‘œ, AI ìš”ì•½               â”‚
â”‚                                                              â”‚
â”‚ 5. ëŒ€ì‹œë³´ë“œ â†’ ëª¨ë“  í…Œì´ë¸”ì˜ í†µí•© ë¶„ì„                        â”‚
â”‚    í™”ë©´: "ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ" KPI, ê·¸ë˜í”„, í†µê³„                 â”‚
â”‚    í•„ìš” ë°ì´í„°: ëª¨ë“  ë°ì´í„°ì˜ ì¢…í•© ë¶„ì„                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì„±í–¥ í…ŒìŠ¤íŠ¸ ë°ì´í„° í™œìš©

> **ğŸ’¡ ì£¼ì„**:
> BluedonuLabì˜ ì°¨ë³„í™” í¬ì¸íŠ¸ëŠ” **ì„±í–¥ ê¸°ë°˜ ë§¤ì¹­**ì…ë‹ˆë‹¤.
> ê¸°ì¡´ ê°„ë³‘ ì„œë¹„ìŠ¤ëŠ” ì˜ë£Œ í•„ìš”ë„(Care Level)ë§Œ ê³ ë ¤í–ˆì§€ë§Œ,
> BluedonuLabì€ **í™˜ìì˜ ì‹¬ë¦¬ì  íŠ¹ì„±**ê¹Œì§€ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ê°„ë³‘ì¸ì„ ì¶”ì²œí•©ë‹ˆë‹¤.
>
> ì„±í–¥ í…ŒìŠ¤íŠ¸ëŠ”:
> - í™˜ìê°€ ì˜¨ë³´ë”©í•  ë•Œ **12ê°œ ë¬¸í•­, ì•½ 5ë¶„**ìœ¼ë¡œ ì™„ë£Œ
> - 4ê°€ì§€ ì¶•(ê³µê°, í™œë™ì„±, ì¸ë‚´ì‹¬, ë…ë¦½ì„±)ìœ¼ë¡œ ì„±ê²© ë¶„ì„
> - ê° ì¶•ì˜ ì ìˆ˜ë¥¼ 0~100ìœ¼ë¡œ ì •ê·œí™”í•˜ì—¬ ê°„ë³‘ì¸ê³¼ ë¹„êµ
> - ì´ë¥¼ í†µí•´ **ì„±í–¥ í˜¸í™˜ë„ ì ìˆ˜** ê³„ì‚°

### 1ï¸âƒ£ ì„±í–¥ ì ìˆ˜ ê³„ì‚° ë¡œì§

#### ì…ë ¥: 12ê°œ í…ŒìŠ¤íŠ¸ ë¬¸í•­ ë‹µë³€

> **ğŸ’¡ ì£¼ì„**:
> ì„±í–¥ í…ŒìŠ¤íŠ¸ëŠ” **ì‹¬ë¦¬ ì„¤ë¬¸ ë””ìì¸** ì›ì¹™ì„ ë”°ë¦…ë‹ˆë‹¤:
> - ê° ì¶•ë‹¹ 3ê°œ ë¬¸í•­ì”© (ì´ 12ê°œ)
> - ê° ë¬¸í•­ì€ 3ê°œ ì„ íƒì§€ (ê¸ì •/ì¤‘ë¦½/ë¶€ì •)
> - ì ìˆ˜ëŠ” -10 ~ +10 ë²”ìœ„ (-30 ~ +30 í•©ê³„ â†’ 0~100ìœ¼ë¡œ ì •ê·œí™”)
> - ë¬¸í•­ ìˆœì„œë¥¼ ì„ì–´ì„œ ì‘ë‹µ í¸í–¥ ë°©ì§€

```python
# ì„±í–¥ í…ŒìŠ¤íŠ¸ ë¬¸í•­ êµ¬ì¡°
# ğŸ’¡ ê° ë¬¸í•­ì€ íŠ¹ì • ì¶•ì„ ì¸¡ì •í•˜ë„ë¡ ì„¤ê³„ë¨
test_questions = [
    {
        'id': 1,
        'question': 'ë°˜ë³µë˜ëŠ” ì§ˆë¬¸ì— ëŒ€í•´ ì–´ë–»ê²Œ í•˜ê¸¸ ì›í•˜ë‚˜ìš”?',
        'axis': 'patience',  # ì–´ëŠ ì¶•ì„ ì¸¡ì •í•˜ëŠ”ê°€?
        'options': [
            {'text': 'ì°¨ë¶„íˆ ì„¤ëª…í•œë‹¤', 'score': 10},
            {'text': 'ì§œì¦ì´ì§€ë§Œ ì°¸ëŠ”ë‹¤', 'score': 5},
            {'text': 'ë°”ë¡œ ëŒ€í™”ë¥¼ ëŒë¦°ë‹¤', 'score': -10}
        ]
    },
    {
        'id': 2,
        'question': 'í˜¼ì í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ìŠ¤ìŠ¤ë¡œ í•˜ê³  ì‹¶ë‹¤',
        'axis': 'independence',
        'options': [
            {'text': 'ì™„ì „íˆ ë™ì˜', 'score': 10},
            {'text': 'ì•½ê°„ ë™ì˜', 'score': 5},
            {'text': 'ë™ì˜í•˜ì§€ ì•ŠìŒ', 'score': -10}
        ]
    },
    # ... ì´ 12ê°œ ë¬¸í•­
]

# ê° ì¶•ë³„ ì ìˆ˜ ë²”ìœ„
PERSONALITY_AXES = {
    'empathy': {
        'label': 'ê³µê° ìš”êµ¬ë„',
        'min': 0,
        'max': 100,
        'questions': [2, 5, 8, 11]  # í•´ë‹¹ ì¶• ë¬¸í•­ ID
    },
    'activity': {
        'label': 'í™œë™ì„±',
        'min': 0,
        'max': 100,
        'questions': [3, 6, 9, 12]
    },
    'patience': {
        'label': 'ê°„ë³‘ì¸ ì¸ë‚´ì‹¬ í•„ìš”ë„',
        'min': 0,
        'max': 100,
        'questions': [1, 4, 7, 10]
    },
    'independence': {
        'label': 'ë…ë¦½ì„±',
        'min': 0,
        'max': 100,
        'questions': [2, 5, 8, 11]
    }
}
```

#### ì²˜ë¦¬: ì ìˆ˜ ê³„ì‚°

> **ğŸ’¡ ì£¼ì„**:
> ì ìˆ˜ ê³„ì‚°ì€ **ì„¸ ë‹¨ê³„**ë¥¼ ê±°ì¹©ë‹ˆë‹¤:
>
> **1ë‹¨ê³„: ìˆ˜ì§‘ (Collection)**
> - ì‚¬ìš©ìê°€ ì„ íƒí•œ ë‹µë³€ì˜ ì ìˆ˜ê°’ì„ ì¶•ë³„ë¡œ ìˆ˜ì§‘
> - ì˜ˆ: ì¸ë‚´ì‹¬ ê´€ë ¨ ë¬¸í•­ 3ê°œì˜ ì ìˆ˜ [10, 5, 10] ìˆ˜ì§‘
>
> **2ë‹¨ê³„: í•©ê³„ (Aggregation)**
> - ê° ì¶•ë³„ë¡œ 3ê°œ ë¬¸í•­ì˜ ì ìˆ˜ë¥¼ í•©ì‚°
> - ë²”ìœ„: -30 ~ +30 (3ê°œ ë¬¸í•­ Ã— -10~+10ì )
>
> **3ë‹¨ê³„: ì •ê·œí™” (Normalization)**
> - í•©ê³„(-30~+30)ë¥¼ 0~100 ë²”ìœ„ë¡œ ë³€í™˜
> - ê³µì‹: ((í•©ê³„ + 30) / 60) Ã— 100
> - ì˜ˆ: í•©ê³„ê°€ 0ì´ë©´ 50ì  (ì¤‘ë¦½), +30ì´ë©´ 100ì  (ë†’ìŒ)
>
> ì´ ì„¸ ë‹¨ê³„ë¥¼ ê±°ì¹¨ìœ¼ë¡œì¨ ì„œë¡œ ë‹¤ë¥¸ ì ìˆ˜ ë²”ìœ„ë¥¼ **ë¹„êµ ê°€ëŠ¥í•œ í˜•íƒœ**ë¡œ ë§Œë“­ë‹ˆë‹¤.

```python
def calculate_personality_scores(user_answers: dict) -> dict:
    """
    í…ŒìŠ¤íŠ¸ ë‹µë³€ â†’ 4ê°œ ì¶• ì ìˆ˜ ê³„ì‚° ë° ì •ê·œí™”

    ì²˜ë¦¬ íë¦„:
    1. ê° ì¶•ë³„ë¡œ ë¬¸í•­ ì ìˆ˜ ìˆ˜ì§‘
    2. ì¶•ë³„ í•©ê³„ ê³„ì‚°
    3. Min-Max ì •ê·œí™”ë¡œ 0~100 ë²”ìœ„ë¡œ ë³€í™˜

    Args:
        user_answers: {question_id: score, ...}
        ì˜ˆ: {1: 10, 2: 5, 3: 10, 4: -10, ...}

        ì‚¬ìš©ìê°€ "ì°¨ë¶„íˆ ì„¤ëª…í•œë‹¤"ë¥¼ ì„ íƒí•˜ë©´ score=10
        "ì§œì¦ì´ì§€ë§Œ ì°¸ëŠ”ë‹¤"ë¥¼ ì„ íƒí•˜ë©´ score=5
        "ë°”ë¡œ ëŒ€í™”ë¥¼ ëŒë¦°ë‹¤"ë¥¼ ì„ íƒí•˜ë©´ score=-10

    Returns:
        {'empathy': 75, 'activity': 55, 'patience': 85, 'independence': 60}

        ê° ì¶•ë³„ 0~100 ë²”ìœ„ì˜ ì ìˆ˜ë¥¼ ë°˜í™˜
        ì ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ í•´ë‹¹ ì¶•ì´ ê°•í•¨ì„ ì˜ë¯¸
    """

    scores = {axis: [] for axis in PERSONALITY_AXES.keys()}
    # ğŸ’¡ ì´ˆê¸°í™”: ê° ì¶•ë³„ë¡œ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ìƒì„±
    # {'empathy': [], 'activity': [], 'patience': [], 'independence': []}

    # 1ï¸âƒ£ ê° ì¶•ë³„ ì ìˆ˜ ìˆ˜ì§‘
    # ğŸ’¡ ê° ì¶•ë§ˆë‹¤ í•´ë‹¹ ë¬¸í•­ë“¤ì˜ ì ìˆ˜ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ëª¨ìŒ
    # ì˜ˆ: patience ì¶•ì€ ë¬¸í•­ [1, 4, 7, 10]ì˜ ì ìˆ˜ [10, 5, 10]ë¥¼ ìˆ˜ì§‘
    for axis_name, axis_info in PERSONALITY_AXES.items():
        # axis_info['questions']ì—ëŠ” ì´ ì¶•ì„ ì¸¡ì •í•˜ëŠ” ë¬¸í•­ ID ë¦¬ìŠ¤íŠ¸ê°€ ìˆìŒ
        # ì˜ˆ: 'patience' â†’ [1, 4, 7, 10]
        axis_scores = [
            user_answers[q_id]  # ê° ë¬¸í•­ì˜ ì ìˆ˜ê°’
            for q_id in axis_info['questions']
            if q_id in user_answers  # ì‚¬ìš©ìê°€ ì´ ë¬¸í•­ì— ë‹µí–ˆë‹¤ë©´
        ]
        scores[axis_name] = axis_scores
        # scores['patience'] = [10, 5, 10]

    # 2ï¸âƒ£ ê° ì¶•ë³„ í•©ê³„ ê³„ì‚°
    # ğŸ’¡ ê° ì¶•ì˜ 3ê°œ ë¬¸í•­ ì ìˆ˜ë¥¼ í•©ì‚° (-30 ~ +30 ë²”ìœ„)
    raw_scores = {
        axis: sum(scores[axis])  # [10, 5, 10] â†’ 25
        for axis in scores.keys()
    }
    # raw_scores['patience'] = 25

    # 3ï¸âƒ£ ì •ê·œí™” (0~100 ë²”ìœ„ë¡œ)
    # ğŸ’¡ ì™œ ì •ê·œí™”ê°€ í•„ìš”í•œê°€?
    # - ì›ë³¸ í•©ê³„ ë²”ìœ„: -30 ~ +30 (3ê°œ ë¬¸í•­ Ã— -10~+10)
    # - ì´ë¥¼ 0 ~ 100 ë²”ìœ„ë¡œ ë³€í™˜í•´ì•¼ ë‹¤ë¥¸ ë°ì´í„°ì™€ ë¹„êµ ê°€ëŠ¥
    # - ê³µì‹: ((raw_score + 30) / 60) * 100
    #   â”œâ”€ raw_scoreê°€ -30ì´ë©´: ((âˆ’30 + 30) / 60) Ã— 100 = 0
    #   â”œâ”€ raw_scoreê°€ 0ì´ë©´: ((0 + 30) / 60) Ã— 100 = 50
    #   â””â”€ raw_scoreê°€ +30ì´ë©´: ((30 + 30) / 60) Ã— 100 = 100

    normalized_scores = {}
    for axis_name, raw_score in raw_scores.items():
        # ì˜ˆ: raw_score = 25 (patienceì˜ í•©ê³„)
        # ì •ê·œí™” ê³µì‹ ì ìš©
        normalized = ((raw_score + 30) / 60) * 100
        # ((25 + 30) / 60) * 100 = 91.67 â†’ 91.7

        # ë²”ìœ„ í´ë¦¬í•‘: í˜¹ì‹œ ê³„ì‚° ì˜¤ë¥˜ë¡œ ë²”ìœ„ ë²—ì–´ë‚œ ê°’ì´ ìˆìœ¼ë©´ ì¡°ì •
        # (ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ ì•ˆì „ì„± ìœ„í•´)
        normalized = max(0, min(100, normalized))
        # 0.1 ì†Œìˆ˜ì ê¹Œì§€ë§Œ ë°˜ì˜¬ë¦¼ (ì €ì¥ íš¨ìœ¨ì„±)
        normalized_scores[axis_name] = round(normalized, 1)
        # normalized_scores['patience'] = 91.7

    # ğŸ’¡ ë°˜í™˜ë˜ëŠ” ë°ì´í„° ì˜ˆì‹œ:
    # {'empathy': 75, 'activity': 55, 'patience': 91.7, 'independence': 60}
    # ì´ ê°’ë“¤ì€ ê°„ë³‘ì¸ì˜ ìŠ¤íƒ€ì¼ ì ìˆ˜ì™€ ì§ì ‘ ë¹„êµ ê°€ëŠ¥í•¨
    return normalized_scores

# ì˜ˆì‹œ ê³„ì‚°:
# ì‚¬ìš©ì ë‹µë³€: {1: 10, 2: 10, 3: 10, 4: -10, 5: 5, 6: 10, 7: 10, 8: 5, 9: 10, 10: 10, 11: 5, 12: 10}
#
# ê° ì¶• í•©ê³„:
# - empathy: 10 + 5 + 10 + 5 = 30
# - activity: 10 + 10 + 10 + 10 = 40
# - patience: 10 + -10 + 10 + 10 = 20
# - independence: 10 + 5 + 5 + 10 = 30
#
# ì •ê·œí™”:
# - empathy: ((30 + 40) / 80) * 100 = 87.5
# - activity: ((40 + 40) / 80) * 100 = 100
# - patience: ((20 + 40) / 80) * 100 = 75
# - independence: ((30 + 40) / 80) * 100 = 87.5
```

#### ì €ì¥: ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥

> **ğŸ’¡ ì£¼ì„**:
> ì„±í–¥ ì ìˆ˜ ì €ì¥ ì‹œ í•„ìš”í•œ ë°ì´í„°:
> - ğŸ“ ì½ê¸°: `Residents.csv`ì—ì„œ í™˜ì ê¸°ë³¸ ì •ë³´ í™•ì¸
> - ğŸ“Š ì €ì¥: `PatientPersonality` í…Œì´ë¸” (ìƒˆë¡œ ìƒì„±í•  í…Œì´ë¸”)
> - ğŸ“Š ì €ì¥: `PersonalityType` ë¶„ë¥˜ ê²°ê³¼ ì €ì¥
> - AI: Azure OpenAIë¥¼ í†µí•´ ì„¤ëª… ìë™ ìƒì„±

```python
import pandas as pd
from datetime import datetime, timedelta

def save_patient_personality(patient_id: int, personality_scores: dict) -> None:
    """
    ê³„ì‚°ëœ ì„±í–¥ ì ìˆ˜ë¥¼ DBì— ì €ì¥

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - Residents.csv (í™˜ì ID ë§¤í•‘ í™•ì¸ìš©)

    ğŸ“Š ì €ì¥ í…Œì´ë¸”:
    - PatientPersonality (í™˜ì ì„±í–¥ ê²°ê³¼)
    - ì»¬ëŸ¼: PatientID, EmpathyScore, ActivityScore, PatienceRequiredScore,
            IndependenceScore, PersonalityType, PersonalityDescription,
            TestCompletedAt, NextReviewDate
    """

    personality_type = classify_personality_type(personality_scores)
    ai_description = generate_ai_description(personality_type, personality_scores)

    # ğŸ“Š PatientPersonality í…Œì´ë¸”ì— ì €ì¥
    patient_personality = PatientPersonality(
        PatientID=patient_id,
        EmpathyScore=int(personality_scores['empathy']),          # ê³µê° ìš”êµ¬ë„ (0~100)
        ActivityScore=int(personality_scores['activity']),        # í™œë™ì„± (0~100)
        PatienceRequiredScore=int(personality_scores['patience']),# ì¸ë‚´ì‹¬ í•„ìš” (0~100)
        IndependenceScore=int(personality_scores['independence']),# ë…ë¦½ì„± (0~100)
        PersonalityType=personality_type,                         # ë¶„ë¥˜ íƒ€ì… (ì˜ˆ: "ì˜ì¡´+ê³µê°í˜•")
        PersonalityDescription=ai_description,                    # AI ìƒì„± ì„¤ëª…
        TestCompletedAt=datetime.now(),
        NextReviewDate=datetime.now() + timedelta(days=180)  # 6ê°œì›” í›„ ì¬í…ŒìŠ¤íŠ¸
    )

    db.add(patient_personality)
    db.commit()

    # ğŸ’¡ ì €ì¥ í™•ì¸: Residents.csvì— í•´ë‹¹ í™˜ì IDê°€ ìˆëŠ”ì§€ ê²€ì¦
    residents_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/Residents.csv')
    if patient_id not in residents_df['ResidentID'].values:
        raise ValueError(f"Patient ID {patient_id}ê°€ Residents.csvì— ì—†ìŠµë‹ˆë‹¤")

    return patient_personality
```

### 2ï¸âƒ£ ì„±í–¥ ë¶„ë¥˜ (AI ê¸°ë°˜)

```python
def classify_personality_type(scores: dict) -> str:
    """
    4ê°œ ì¶• ì ìˆ˜ â†’ ì„±í–¥ íƒ€ì… ë¶„ë¥˜

    ë¶„ë¥˜ ê¸°ì¤€:
    - Empathy ë†’ìŒ (>60) & Independence ë‚®ìŒ (<40): ì˜ì¡´+ê³µê°í˜•
    - Empathy ë†’ìŒ (>60) & Independence ë†’ìŒ (>60): ìë¦½+ê³µê°í˜•
    - Empathy ë‚®ìŒ (<40) & Independence ë†’ìŒ (>60): ìë¦½+íš¨ìœ¨í˜•
    - Empathy ë‚®ìŒ (<40) & Independence ë‚®ìŒ (<40): ì˜ì¡´+íš¨ìœ¨í˜•
    """

    empathy = scores['empathy']
    independence = scores['independence']

    if empathy >= 60:
        if independence >= 60:
            return 'ìë¦½ + ê³µê°í˜•'  # "ë“ ë“ í•¨ ì›í•¨"
        else:
            return 'ì˜ì¡´ + ê³µê°í˜•'  # "ë”°ëœ»í•¨ ì›í•¨"
    else:
        if independence >= 60:
            return 'ìë¦½ + íš¨ìœ¨í˜•'  # "í”„ë¡œë‹µìŒ"
        else:
            return 'ì˜ì¡´ + íš¨ìœ¨í˜•'  # "ì²´ê³„ì  ê´€ë¦¬"

# ì˜ˆì‹œ:
# scores = {'empathy': 80, 'activity': 40, 'patience': 85, 'independence': 35}
# â†’ 'ì˜ì¡´ + ê³µê°í˜•' (ê°ì •ì  ì§€ì§€ê°€ ì¤‘ìš”í•˜ê³  ìì£¼ ë„ì›€ í•„ìš”)
```

#### AI ê¸°ë°˜ ì„¤ëª… ìƒì„±

```python
from azure.ai.openai import OpenAIClient

def generate_ai_description(personality_type: str, scores: dict) -> str:
    """
    ì„±í–¥ íƒ€ì… + ì ìˆ˜ â†’ AIê°€ ìƒì„±í•œ ìì—°ì–´ ì„¤ëª…

    í”„ë¡¬í”„íŠ¸: ë”°ëœ»í•˜ê³  ê¸ì •ì ì¸ í†¤ìœ¼ë¡œ 1~2ë¬¸ì¥ ì‘ì„±
    """

    prompt = f"""
    ë‹¹ì‹ ì€ BluedonuLab ê°„ë³‘ ì„œë¹„ìŠ¤ì˜ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.
    í™˜ìì˜ ì„±í–¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë”°ëœ»í•˜ê³  ê¸ì •ì ì¸ ì„¤ëª…ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

    ì„±í–¥ íƒ€ì…: {personality_type}
    - ê³µê° ìš”êµ¬ë„: {scores['empathy']}/100
    - í™œë™ì„±: {scores['activity']}/100
    - ê°„ë³‘ì¸ ì¸ë‚´ì‹¬ í•„ìš”: {scores['patience']}/100
    - ë…ë¦½ì„±: {scores['independence']}/100

    ìš”ì²­ì‚¬í•­:
    1. í™˜ìë¥¼ ì¡´ì¤‘í•˜ê³  ê¸ì •ì ìœ¼ë¡œ í‘œí˜„í•˜ì„¸ìš”
    2. í™˜ìì˜ ì„±í–¥ì„ ì •í™•íˆ ë°˜ì˜í•˜ì„¸ìš”
    3. ì–´ë–¤ ì¢…ë¥˜ì˜ ê°„ë³‘ì¸ê³¼ ì˜ ë§ì„ì§€ ì•”ì‹œí•˜ì„¸ìš”
    4. 1~2ë¬¸ì¥ ì •ë„ë¡œ ì‘ì„±í•˜ì„¸ìš”
    5. ì´ëª¨ì§€ 1~2ê°œ í¬í•¨í•˜ì„¸ìš”

    ì˜ˆì‹œ:
    "ë‹¹ì‹ ì€ ê°ì •ì  ì§€ì§€ê°€ ë§¤ìš° ì¤‘ìš”í•˜ë©°,
    ê°„ë³‘ì¸ì˜ ì¸ë‚´ì‹¬ê³¼ ë”°ëœ»í•œ ê³µê°ì„ ì›í•˜ëŠ” ë¶„ì…ë‹ˆë‹¤.
    ì²œì²œíˆ ì—¬ëŸ¬ ë²ˆ ì„¤ëª…í•´ì£¼ëŠ” ìŠ¤íƒ€ì¼ì˜ ê°„ë³‘ì¸ê³¼ ì˜ ë§ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ğŸ’™"
    """

    # Azure OpenAI í˜¸ì¶œ
    response = openai_client.chat.completions.create(
        model="gpt-4",
        messages=[{"role": "user", "content": prompt}],
        temperature=0.7,
        max_tokens=150
    )

    return response.choices[0].message.content
```

---

## ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ ë°ì´í„° íë¦„

> **ğŸ’¡ ì£¼ì„**:
> ê°„ë³‘ì¸ì˜ ëŒë´„ ìŠ¤íƒ€ì¼ì€ **í…ŒìŠ¤íŠ¸ë¡œ ì–»ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤**.
> ì™œëƒí•˜ë©´ ê°„ë³‘ì¸ì´ ì˜ì‹ì ìœ¼ë¡œ ì–´ë–»ê²Œ í–‰ë™í• ì§€ ë§í•  ìˆ˜ëŠ” ìˆì§€ë§Œ,
> **ì‹¤ì œ í–‰ë™**ì´ ì ìˆ˜ë¥¼ ë°˜ì˜í•´ì•¼ ì‹ ë¢°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
>
> ë”°ë¼ì„œ BluedonuLabì€ **í–‰ë™ ê¸°ë°˜ ë¶„ì„**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
> 1. ì´ì „ í™˜ìë“¤ì˜ ë¦¬ë·°ì—ì„œ í‚¤ì›Œë“œ ì¶”ì¶œ (ì˜ˆ: "ë”°ëœ»í–ˆì–´ìš”" â†’ ê³µê°ë ¥ ë†’ìŒ)
> 2. ìê¸°ì†Œê°œ í…ìŠ¤íŠ¸ ë¶„ì„ (ì˜ˆ: "í™˜ì ì…ì¥ì„ ìƒê°í•©ë‹ˆë‹¤" â†’ ê³µê°ë ¥ ë†’ìŒ)
> 3. ì‹¤ì œ ì¼€ì–´ ê¸°ë¡ ë¶„ì„ (ì˜ˆ: ì¼ì¼ ë¦¬í¬íŠ¸ì— ê°ì • í‘œí˜„ì´ ë§ì€ê°€?)
>
> ì´ 3ê°€ì§€ë¥¼ **ê°€ì¤‘ì¹˜**ë¡œ í•©ì¹˜ë©´ ê°ê´€ì ì¸ ìŠ¤íƒ€ì¼ ì ìˆ˜ê°€ ë‚˜ì˜µë‹ˆë‹¤.

### 1ï¸âƒ£ ê°„ë³‘ì¸ ëŒë´„ ìŠ¤íƒ€ì¼ ê³„ì‚°

```python
import pandas as pd
from datetime import datetime, timedelta

def calculate_caregiver_style_score(caregiver_id: int) -> dict:
    """
    ê°„ë³‘ì¸ì˜ ê³¼ê±° ë¦¬ë·°/ì¼€ì–´ ê¸°ë¡ â†’ 4ê°œ ì¶• ìŠ¤íƒ€ì¼ ì ìˆ˜ ê³„ì‚°

    ğŸ“ ì‚¬ìš© íŒŒì¼ & í…Œì´ë¸”:
    - Residents.csv (í™˜ì ID ë§¤í•‘ìš©, í•„ìš”ì‹œ)
    - staff.csv (ê°„ë³‘ì¸ ê¸°ë³¸ ì •ë³´ - CaregiverID í™•ì¸)
    - medications.csv (ì•½ë¬¼ ë³µì¡ë„ - ê°„ë³‘ì¸ ê²½ë ¥ ê³„ì‚°ìš©)

    ğŸ“Š ì½ê¸° í…Œì´ë¸” (ìƒˆë¡œ ìƒì„±í•  í…Œì´ë¸”):
    - Review (ì´ì „ í™˜ìì˜ ë¦¬ë·° í…ìŠ¤íŠ¸)
    - CareLog (ê°„ë³‘ì¸ ì¼ì¼ ê¸°ë¡ ë…¸íŠ¸)
    - CaregiverProfile (ê°„ë³‘ì¸ ìê¸°ì†Œê°œ í…ìŠ¤íŠ¸)

    ğŸ“Š ì €ì¥ í…Œì´ë¸”:
    - CaregiverStyle (ê³„ì‚°ëœ 4ì¶• ìŠ¤íƒ€ì¼ ì ìˆ˜)

    ğŸ’¡ í•µì‹¬ ê°œë…: ê°„ë³‘ì¸ì˜ ì ìˆ˜ëŠ” **ê·¸ë“¤ì˜ í–‰ë™ ê¸°ë¡**ì—ì„œ ë‚˜ì˜µë‹ˆë‹¤.
    ë‹¨ìˆœíˆ ìì‹ ì´ ëˆ„êµ¬ë¼ê³  ìƒê°í•˜ëŠ”ì§€ê°€ ì•„ë‹ˆë¼,
    ì‹¤ì œë¡œ ê³¼ê±° í™˜ìë“¤ì´ ì–´ë–»ê²Œ ê²½í—˜í–ˆëŠ”ì§€ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.

    ë°ì´í„° ì†ŒìŠ¤ (ì‹ ë¢°ë„ ìˆœ):
    1. Review í…Œì´ë¸” (ì´ì „ í™˜ìì˜ ë¦¬ë·°) - 50% ê°€ì¤‘ì¹˜
       â””â”€ ê°€ì¥ ì‹ ë¢°ë„ ë†’ìŒ (ì‹¤ì œ í™˜ì í”¼ë“œë°±)
    2. CareLog í…Œì´ë¸” (ì‹¤ì‹œê°„ ì¼€ì–´ ê¸°ë¡) - 30% ê°€ì¤‘ì¹˜
       â””â”€ ê°„ë³‘ì¸ì˜ ì¼ì¼ ê¸°ë¡ ìŠ¤íƒ€ì¼ ë¶„ì„
    3. CaregiverProfile í…Œì´ë¸” (ìê¸°ì†Œê°œ í…ìŠ¤íŠ¸) - 20% ê°€ì¤‘ì¹˜
       â””â”€ ìì‹ ì˜ ì§„ìˆ  (ìê¸° ì„ ì „ì¼ ìˆ˜ ìˆìŒ)
    """

    # ğŸ’¡ ê°„ë³‘ì¸ ë°ì´í„° ìœ íš¨ì„± í™•ì¸
    staff_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/staff.csv')
    if caregiver_id not in staff_df['StaffID'].values:
        raise ValueError(f"Caregiver ID {caregiver_id}ê°€ staff.csvì— ì—†ìŠµë‹ˆë‹¤")

    # 1ï¸âƒ£ ë¦¬ë·° ê¸°ë°˜ ê°ì • ë¶„ì„ (ê°€ì¥ ì‹ ë¢°ë„ ë†’ìŒ)
    # ğŸ’¡ ì™œ ë¦¬ë·°ê°€ ì¤‘ìš”í•œê°€?
    # - í™˜ìë“¤ì˜ ì‹¤ì œ ê²½í—˜ì´ ë°˜ì˜ë¨
    # - ë‹¤ì–‘í•œ í™˜ìë“¤ì˜ í‰ê°€ê°€ í‰ê· í™”ë¨ (í¸í–¥ ìµœì†Œí™”)
    # - ìƒˆë¡œìš´ ê°„ë³‘ì¸(ë¦¬ë·° ì—†ìŒ)ì€ ì´í›„ ìƒì„±ë¨

    # ğŸ“Š Review í…Œì´ë¸”ì—ì„œ ì¡°íšŒ
    reviews = db.query(Review).filter(
        Review.CaregiverID == caregiver_id,
        Review.CreatedAt >= datetime.now() - timedelta(days=365)  # ìµœê·¼ 1ë…„ë§Œ ê³ ë ¤
        # ğŸ’¡ ì™œ 1ë…„ë§Œ? ì˜¤ë˜ëœ ë¦¬ë·°ëŠ” ê°„ë³‘ì¸ì˜ í˜„ì¬ ëŠ¥ë ¥ì„ ë°˜ì˜í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ
    ).all()

    review_texts = [review.content for review in reviews]
    # ğŸ’¡ ë¦¬ë·° ì˜ˆì‹œ:
    # "ê¹€ ê°„ë³‘ì¸ì€ ë§¤ìš° ë”°ëœ»í•˜ê³  ì €ì˜ ê°ì •ì„ ì˜ ì´í•´í•´ì¤¬ì–´ìš”"
    # "ë°˜ë³µëœ ì„¤ëª…ë„ ì°¸ì•„ì£¼ê³  ì¸ë‚´ì‹¬ì´ ì¢‹ì•˜ìŠµë‹ˆë‹¤"
    # "ì•„ì£¼ ì „ë¬¸ì ì´ê³  ê¹”ë”í•˜ê²Œ ì¼€ì–´í•´ì£¼ì…¨ì–´ìš”"

    empathy_from_reviews = analyze_sentiment_batch(
        review_texts,
        dimension='empathy'  # "ë”°ëœ»í–ˆì–´ìš”", "ê³µê°í•´ì¤¬ì–´ìš”" ë“±ì˜ í‚¤ì›Œë“œ ê²€ìƒ‰
    )
    # ë°˜í™˜: 0~100 ì ìˆ˜ (ì˜ˆ: 85 = ë¦¬ë·°ì—ì„œ ê³µê° í‚¤ì›Œë“œê°€ ë§ìŒ)

    # 2ï¸âƒ£ ìê¸°ì†Œê°œ í…ìŠ¤íŠ¸ ë¶„ì„ (ì¤‘ê°„ ì‹ ë¢°ë„)
    # ğŸ“Š CaregiverProfile í…Œì´ë¸”ì—ì„œ ì¡°íšŒ (ë˜ëŠ” staff.csvì˜ bio ì»¬ëŸ¼)
    profile = db.query(CaregiverProfile).filter(
        CaregiverProfile.CaregiverID == caregiver_id
    ).first()

    if not profile:
        # ğŸ’¡ ëŒ€ì²´ ë°©ë²•: staff.csvì˜ bio ì»¬ëŸ¼ ì‚¬ìš©
        staff_bio = staff_df[staff_df['StaffID'] == caregiver_id]['Bio'].values
        bio_text = staff_bio[0] if len(staff_bio) > 0 else ""
    else:
        bio_text = profile.bio

    empathy_from_bio = analyze_text_for_traits(
        bio_text,
        traits=['empathy', 'patience', 'warmth', 'compassion']
    )['empathy']
    # ğŸ’¡ ìê¸°ì†Œê°œ ì˜ˆì‹œ:
    # "ì €ëŠ” í™˜ìë¶„ë“¤ì˜ ê°ì •ì„ ì†Œì¤‘íˆ ì—¬ê¸°ë©°,
    #  í•­ìƒ ê³µê°ê³¼ ë°°ë ¤ë¡œ ì¼€ì–´í•˜ëŠ” ê°„ë³‘ì¸ì…ë‹ˆë‹¤"
    # ë°˜í™˜: 0~100 ì ìˆ˜ (ì˜ˆ: 75 = ìê¸°ì†Œê°œì—ì„œ ë”°ëœ»í•¨, ê³µê° í‘œí˜„ ìˆìŒ)

    # 3ï¸âƒ£ ì¼€ì–´ ë¡œê·¸ ê¸°ë°˜ ë¶„ì„ (ì‹¤ì‹œê°„ ê¸°ë¡)
    # ğŸ’¡ ì¼€ì–´ ë¡œê·¸ë€? ê°„ë³‘ì¸ì´ ë§¤ì¼ ì‘ì„±í•˜ëŠ” í™œë™ ê¸°ë¡
    # ğŸ“Š CareLog í…Œì´ë¸”ì—ì„œ ì¡°íšŒ (ê°„ë³‘ì¸ì˜ ì¼ì¼ ë…¸íŠ¸ í…ìŠ¤íŠ¸)
    care_logs = db.query(CareLog).filter(
        CareLog.CaregiverID == caregiver_id,
        CareLog.CareDate >= datetime.now().date() - timedelta(days=90)  # ìµœê·¼ 3ê°œì›”
    ).all()

    log_texts = [log.notes for log in care_logs if log.notes]
    # ğŸ’¡ ì¼€ì–´ë¡œê·¸ ì˜ˆì‹œ:
    # "í• ë¨¸ë‹ˆê°€ ë°˜ë³µí•´ì„œ ì§ˆë¬¸í–ˆì§€ë§Œ ì°¨ë¶„íˆ ì„¤ëª…í•´ë“œë ¸ìŠµë‹ˆë‹¤"
    # "ì˜¤ëŠ˜ì€ í• ë¨¸ë‹ˆì™€ í•¨ê»˜ 30ë¶„ ì‚°ì±…ì„ í–ˆê³  ë§¤ìš° ì¦ê±°ì›Œí•˜ì…¨ìŠµë‹ˆë‹¤"

    empathy_from_logs = analyze_care_logs_for_empathy(log_texts)
    # ë°˜í™˜: 0~100 ì ìˆ˜ (ì˜ˆ: 88 = ë¡œê·¸ì—ì„œ ê°ì • í‘œí˜„, í™˜ì ì¤‘ì‹¬ ê¸°ìˆ  ë§ìŒ)

    # 4ï¸âƒ£ ê°€ì¤‘ í‰ê·  (3ê°€ì§€ ì†ŒìŠ¤ì˜ ì‹ ë¢°ë„ë¥¼ ë°˜ì˜)
    # ğŸ’¡ ê°€ì¤‘ì¹˜ ì„¤ì • ì›ì¹™:
    # - ë¦¬ë·°(50%): ë‹¤ìˆ˜ì˜ í™˜ì í”¼ë“œë°± â†’ ê°€ì¥ ê°ê´€ì 
    # - ì¼€ì–´ë¡œê·¸(30%): ì¼ì¼ ê¸°ë¡ â†’ ì§ì ‘ í–‰ë™ì˜ ì¦ê±°
    # - ìê¸°ì†Œê°œ(20%): ìì‹ ì˜ ë§ â†’ ìê¸° ì„ ì „ì˜ ê°€ëŠ¥ì„±

    empathy_score = (
        empathy_from_reviews * 0.50 +  # 50%: í™˜ì ë¦¬ë·°ê°€ ê°€ì¥ ì¤‘ìš”
        empathy_from_logs * 0.30 +      # 30%: ì‹¤ì œ ì¼€ì–´ ê¸°ë¡
        empathy_from_bio * 0.20         # 20%: ìê¸°ì†Œê°œ
    )
    # ğŸ’¡ ì˜ˆì‹œ ê³„ì‚°:
    # empathy_from_reviews = 85
    # empathy_from_logs = 88
    # empathy_from_bio = 75
    # ìµœì¢… ì ìˆ˜ = 85*0.5 + 88*0.3 + 75*0.2 = 42.5 + 26.4 + 15 = 83.9

    # ë‹¤ë¥¸ ì¶•ë„ ë™ì¼ ë°©ì‹ìœ¼ë¡œ ê³„ì‚°
    activity_score = calculate_activity_score(caregiver_id)
    patience_score = calculate_patience_score(caregiver_id)
    independence_support_score = calculate_independence_support_score(caregiver_id)

    return {
        'caregiver_id': caregiver_id,
        'empathy_score': round(empathy_score, 1),
        'activity_score': round(activity_score, 1),
        'patience_score': round(patience_score, 1),
        'independence_support_score': round(independence_support_score, 1),
        'calculation_timestamp': datetime.now(),
        'data_sources': {
            'reviews_analyzed': len(reviews),
            'bio_available': profile is not None,
            'recent_logs': len(care_logs)
        }
    }
```

#### ê°ì • ë¶„ì„ êµ¬í˜„ ì˜ˆì‹œ

```python
from azure.ai.language import TextAnalyticsClient
from azure.core.credentials import AzureKeyCredential

def analyze_sentiment_batch(texts: list, dimension: str) -> float:
    """
    ì—¬ëŸ¬ í…ìŠ¤íŠ¸ì˜ ê°ì • ë¶„ì„ â†’ í‰ê·  ì ìˆ˜ ë°˜í™˜

    dimension:
    - 'empathy': "ë”°ëœ»í–ˆì–´ìš”", "ê³µê°í•´ì¤¬ì–´ìš”", "ë§ˆìŒì´ í¸í–ˆì–´ìš”" ë“±
    - 'patience': "ë°˜ë³µëœ ì„¤ëª…ë„ ì°¸ì•„ì¤¬ì–´ìš”", "ì¸ë‚´ì‹¬ ìˆìœ¼ì…¨ì–´ìš”" ë“±
    - 'activity': "ìì£¼ í™œë™ì„ ê¶Œí•´ì¤¬ì–´ìš”", "í™œë™ì ì´ì…¨ì–´ìš”" ë“±
    """

    if not texts:
        return 50  # ê¸°ë³¸ê°’

    client = TextAnalyticsClient(
        endpoint="<YOUR_ENDPOINT>",
        credential=AzureKeyCredential("<YOUR_KEY>")
    )

    # í‚¤ì›Œë“œ ê¸°ë°˜ ìŠ¤ì½”ì–´ë§
    KEYWORD_MAP = {
        'empathy': [
            'ë”°ëœ»', 'ê³µê°', 'ì´í•´', 'í¸í–ˆ', 'ë§ˆìŒ', 'ê°ì •',
            'ë°°ë ¤', 'ì¹œì ˆ', 'ë”°ë“¯', 'ê°ì‹¸ì£¼', 'ì•ˆì•„ì£¼'
        ],
        'patience': [
            'ë°˜ë³µ', 'ì°¸', 'ì¸ë‚´', 'ëŠë¦°', 'ì²œì²œíˆ', 'ì„¤ëª…',
            'ê¸°ë‹¤ë ¤', 'ê´œì°®', 'ê´œì°®ì•˜'
        ],
        'activity': [
            'í™œë™', 'ì›€ì§', 'ì‚°ì±…', 'ìš´ë™', 'ë‚˜ê°”', 'í™œë°œ',
            'ë°”ìœ', 'ìê·¹', 'ë‹¤ì–‘'
        ]
    }

    scores = []
    for text in texts:
        text_lower = text.lower()
        keyword_count = sum(
            1 for keyword in KEYWORD_MAP.get(dimension, [])
            if keyword in text_lower
        )
        # í‚¤ì›Œë“œë‹¹ +10ì  (ìµœëŒ€ 100ì )
        score = min(50 + (keyword_count * 10), 100)
        scores.append(score)

    return sum(scores) / len(scores) if scores else 50
```

### 2ï¸âƒ£ ì„±í–¥ í˜¸í™˜ë„ ê³„ì‚°

> **ğŸ’¡ ì£¼ì„**:
> ì„±í–¥ í˜¸í™˜ë„ ê³„ì‚°ì€ **BluedonuLabì˜ í•µì‹¬ ê¸°ìˆ **ì…ë‹ˆë‹¤.
>
> **ê¸°ë³¸ ì›ì¹™**:
> - í™˜ìì™€ ê°„ë³‘ì¸ì˜ ê° ì¶•ë³„ ì ìˆ˜ë¥¼ **ë¹„êµ**
> - ì ìˆ˜ê°€ ë¹„ìŠ·í• ìˆ˜ë¡ ë†’ì€ í˜¸í™˜ë„ (ê³µê°: 80 vs 85 = í˜¸í™˜ë„ 95)
> - ì ìˆ˜ê°€ ë‹¤ë¥¼ìˆ˜ë¡ ë‚®ì€ í˜¸í™˜ë„ (ê³µê°: 80 vs 20 = í˜¸í™˜ë„ 40)
>
> **ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°**:
> - í™˜ìê°€ í™œë™ì„± 40ì  (ì¡°ìš©í•œ ìŠ¤íƒ€ì¼)
> - ê°„ë³‘ì¸ì´ í™œë™ì„± 70ì  (í™œë™ì ì¸ ìŠ¤íƒ€ì¼)
> - í˜¸í™˜ë„ = 100 - |40-70| = 100 - 30 = 70ì  â†’ ë‹¤ì†Œ ë§ì§€ ì•ŠìŒ
>
> ë§Œì•½ ê°„ë³‘ì¸ì´ í™œë™ì„± 38ì ì´ì—ˆë‹¤ë©´:
> - í˜¸í™˜ë„ = 100 - |40-38| = 100 - 2 = 98ì  â†’ ë§¤ìš° ì˜ ë§ìŒ

```python
def calculate_personality_compatibility(
    patient_personality: dict,
    caregiver_style: dict
) -> dict:
    """
    í™˜ì ì„±í–¥ vs ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ â†’ í˜¸í™˜ë„ ì ìˆ˜

    ğŸ’¡ í•µì‹¬ ê°œë…:
    ì„±í–¥ì´ "ì¼ì¹˜"í•œë‹¤ëŠ” ê²ƒì€ ì„±ê²©ì˜ ëª¨ë“  ë©´ì´ ê°™ë‹¤ëŠ” ëœ»ì´ ì•„ë‹™ë‹ˆë‹¤.
    ì˜¤íˆë ¤ "í•„ìš”í•œ ê²ƒ"ê³¼ "ì œê³µí•  ìˆ˜ ìˆëŠ” ê²ƒ"ì´ ì¼ì¹˜í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.

    ì˜ˆë¥¼ ë“¤ì–´:
    - ê³µê°ì´ í•„ìš”í•œ í™˜ì(80) + ê³µê°ì ì¸ ê°„ë³‘ì¸(85) = ì¢‹ì€ ë§¤ì¹­
    - í™œë™ì´ ì ì€ í™˜ì(40) + í™œë™ì ì´ì§€ ì•Šì€ ê°„ë³‘ì¸(35) = ì¢‹ì€ ë§¤ì¹­
    - í™œë™ì´ ì ì€ í™˜ì(40) + í™œë™ì ì¸ ê°„ë³‘ì¸(80) = ë‚˜ìœ ë§¤ì¹­ (ì–µì§€ë¡œ ì›€ì§ì„)
    """

    # ğŸ’¡ ì˜ˆì‹œ ë°ì´í„°:
    # í™˜ì ì¡´: ê³µê° ìš”êµ¬ ë†’ìŒ, í™œë™ì„± ë‚®ìŒ, ì¸ë‚´ì‹¬ í•„ìš” ë†’ìŒ, ë…ë¦½ì„± ë‚®ìŒ
    patient_personality = {
        'empathy': 80,          # ê°ì • ì§€ì§€ê°€ ì •ë§ ì¤‘ìš”
        'activity': 40,         # ì¡°ìš©í•˜ê³  ì°¨ë¶„í•œ í™˜ê²½ ì„ í˜¸
        'patience': 85,         # ë°˜ë³µ ì„¤ëª… ê´œì°®ìŒ
        'independence': 35      # ìì£¼ ë„ì›€ í•„ìš”
    }

    # ğŸ’¡ ê°„ë³‘ì¸ ê¹€: ê³µê°ì ì´ê³  í™œë™ì ì´ë©° ì¸ë‚´ì‹¬ ìˆëŠ” íƒ€ì…
    caregiver_style = {
        'empathy_score': 85,    # ê³µê°ë ¥ ë†’ìŒ (ë¦¬ë·°ì—ì„œ "ë”°ëœ»í•˜ë‹¤"ëŠ” í‰ê°€ ë§ìŒ)
        'activity_score': 55,   # ì ë‹¹íˆ í™œë™ì  (ê°•ìš”í•˜ì§€ ì•ŠìŒ)
        'patience_score': 90,   # ì¸ë‚´ì‹¬ ë§¤ìš° ë†’ìŒ (ë°˜ë³µëœ ì„¤ëª… ok)
        'independence_support_score': 40  # í•„ìš”ì‹œ ë„ì›€ ì œê³µ
    }

    # 1ï¸âƒ£ ê° ì¶•ë³„ í˜¸compatë„ ê³„ì‚° (ìœ ì‚¬ë„)
    # ğŸ’¡ ê³µì‹ì˜ ì˜ë¯¸: 100 - |í™˜ìì ìˆ˜ - ê°„ë³‘ì¸ì ìˆ˜|
    # - ì°¨ì´ê°€ 0ì´ë©´ (ê°™ìœ¼ë©´) 100ì  (ì™„ë²½í•œ ë§¤ì¹­)
    # - ì°¨ì´ê°€ 10ì´ë©´ 90ì  (ì¢‹ì€ ë§¤ì¹­)
    # - ì°¨ì´ê°€ 40ì´ë©´ 60ì  (ë¬¸ì œ ìˆëŠ” ë§¤ì¹­)

    compatibility_scores = {
        'empathy_match': 100 - abs(
            # |80 - 85| = 5 â†’ 100 - 5 = 95ì  (ë§¤ìš° ì˜ ë§ìŒ)
            patient_personality['empathy'] -
            caregiver_style['empathy_score']
        ),

        'activity_match': 100 - abs(
            # |40 - 55| = 15 â†’ 100 - 15 = 85ì  (ì˜ ë§ìŒ)
            patient_personality['activity'] -
            caregiver_style['activity_score']
        ),

        'patience_match': 100 - abs(
            # |85 - 90| = 5 â†’ 100 - 5 = 95ì  (ë§¤ìš° ì˜ ë§ìŒ)
            patient_personality['patience'] -
            caregiver_style['patience_score']
        ),

        'independence_match': 100 - abs(
            # |35 - 40| = 5 â†’ 100 - 5 = 95ì  (ë§¤ìš° ì˜ ë§ìŒ)
            patient_personality['independence'] -
            caregiver_style['independence_support_score']
        ),
    }
    # ê²°ê³¼: {'empathy_match': 95, 'activity_match': 85, 'patience_match': 95, 'independence_match': 95}

    # 2ï¸âƒ£ ìµœì¢… í˜¸í™˜ë„ (4ê°œ ì¶• í‰ê· )
    # ğŸ’¡ ëª¨ë“  ì¶•ì´ ë™ë“±í•˜ê²Œ ì¤‘ìš”í•˜ë‹¤ê³  ê°€ì •
    # (ë§Œì•½ ì–´ë–¤ ì¶•ì´ ë” ì¤‘ìš”í•˜ë©´ ê°€ì¤‘ì¹˜ë¥¼ ë‹¤ë¥´ê²Œ ì„¤ì • ê°€ëŠ¥)
    overall_compatibility = sum(compatibility_scores.values()) / 4
    # (95 + 85 + 95 + 95) / 4 = 92.5ì  â†’ ìš°ìˆ˜í•œ ë§¤ì¹­!

    return {
        'overall_compatibility': round(overall_compatibility, 1),
        # 92.5 â†’ 92.5 (ìµœì¢… í˜¸í•©ë„ ì ìˆ˜)

        'detailed_scores': {k: round(v, 1) for k, v in compatibility_scores.items()},
        # ê° ì¶•ë³„ ì ìˆ˜ ìƒì„¸ ì •ë³´

        'strengths': identify_matching_strengths(compatibility_scores),
        # í˜¸í™˜ë„ ë†’ì€ ì¶•ë“¤ (>85ì )

        'concerns': identify_matching_concerns(compatibility_scores)
        # í˜¸í™˜ë„ ë‚®ì€ ì¶•ë“¤ (<60ì )
    }

def identify_matching_strengths(scores: dict) -> list:
    """
    í˜¸í™˜ë„ê°€ ë†’ì€ ì¶• ì°¾ê¸° (>85ì )
    """
    return [
        axis.replace('_match', '')
        for axis, score in scores.items()
        if score > 85
    ]

def identify_matching_concerns(scores: dict) -> list:
    """
    í˜¸í™˜ë„ê°€ ë‚®ì€ ì¶• ì°¾ê¸° (<60ì )
    """
    return [
        axis.replace('_match', '')
        for axis, score in scores.items()
        if score < 60
    ]

# ì˜ˆì‹œ ê²°ê³¼:
# {
#     'overall_compatibility': 92.5,
#     'detailed_scores': {
#         'empathy_match': 95,
#         'activity_match': 85,
#         'patience_match': 95,
#         'independence_match': 95
#     },
#     'strengths': ['empathy', 'patience', 'independence'],
#     'concerns': []
# }
```

---

## UIë³„ ë°ì´í„° ì¿¼ë¦¬ & ì—°ë™

> **ğŸ’¡ ì£¼ì„**:
> ì´ ì„¹ì…˜ì€ **ê° UI í™”ë©´ì´ ì–´ë–¤ ë°ì´í„°ë¥¼ í•„ìš”ë¡œ í•˜ëŠ”ì§€** ë³´ì—¬ì¤ë‹ˆë‹¤.
> ê°œë°œí•  ë•Œ ì´ ì½”ë“œë¥¼ ë³µì‚¬-ë¶™ì—¬ë„£ê¸° í•˜ë©´ ë©ë‹ˆë‹¤.
>
> **êµ¬ì¡°**:
> 1. API ì—”ë“œí¬ì¸íŠ¸ (ë°±ì—”ë“œ)
> 2. ë°ì´í„° ì²˜ë¦¬ ë¡œì§
> 3. ì‘ë‹µ í¬ë§· (í”„ë¡ íŠ¸ì—”ë“œê°€ ë°›ì„ JSON êµ¬ì¡°)
> 4. React ì»´í¬ë„ŒíŠ¸ ì˜ˆì‹œ

### 1ï¸âƒ£ ì„±í–¥ í…ŒìŠ¤íŠ¸ ì™„ë£Œ â†’ ê²°ê³¼ í™”ë©´

**ì‚¬ìš© ë°ì´í„°**: `PatientPersonality` í…Œì´ë¸”ì— ì ìˆ˜ ì €ì¥ + AI ì„¤ëª… ìƒì„±

> **ğŸ’¡ ì£¼ì„**:
> ì´ í™”ë©´ì€ ê°€ì¥ ê°„ë‹¨í•©ë‹ˆë‹¤.
> - ì…ë ¥: ì‚¬ìš©ìì˜ 12ê°œ ë¬¸í•­ ë‹µë³€
> - ì²˜ë¦¬: ì ìˆ˜ ê³„ì‚° + AI ì„¤ëª… ìƒì„±
> - ì¶œë ¥: ë ˆì´ë” ì°¨íŠ¸ + í•œ ë¬¸ì¥ ìš”ì•½
>
> **íë¦„**:
> ì‚¬ìš©ìê°€ "ë‹¤ìŒ" í´ë¦­
>   â†“
> í”„ë¡ íŠ¸ì—”ë“œê°€ ë‹µë³€ ë°ì´í„°ë¥¼ APIì— POST
>   â†“
> ë°±ì—”ë“œê°€ ì ìˆ˜ ê³„ì‚° (calculate_personality_scores)
>   â†“
> ë°±ì—”ë“œê°€ DBì— ì €ì¥ (PatientPersonality í…Œì´ë¸”)
>   â†“
> ë°±ì—”ë“œê°€ AIë¡œ ì„¤ëª… ìƒì„± (Azure OpenAI)
>   â†“
> í”„ë¡ íŠ¸ì—”ë“œê°€ ë°›ì€ ë°ì´í„°ë¡œ ê²°ê³¼ í™”ë©´ ë Œë”ë§

```python
# FastAPI ì—”ë“œí¬ì¸íŠ¸
@app.post("/api/personality-test/submit")
async def submit_personality_test(
    patient_id: int,
    answers: dict  # {question_id: score, ...}
    # ğŸ’¡ ì˜ˆì‹œ: {1: 10, 2: 5, 3: 10, 4: -10, 5: 5, 6: 10, ...}
):
    """
    ì„±í–¥ í…ŒìŠ¤íŠ¸ ì œì¶œ â†’ ì ìˆ˜ ê³„ì‚° â†’ DB ì €ì¥ â†’ ê²°ê³¼ ë°˜í™˜

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - Residents.csv (í™˜ì ID ê²€ì¦)

    ğŸ“Š ì €ì¥ í…Œì´ë¸”:
    - PatientPersonality (ì„±í–¥ ì ìˆ˜ ì €ì¥)

    ì´ í•¨ìˆ˜ì˜ ì—­í• :
    1. ì‚¬ìš©ì ë‹µë³€ ë°›ê¸°
    2. ì ìˆ˜ ê³„ì‚°í•˜ê¸°
    3. DBì— ì €ì¥í•˜ê¸°
    4. í”„ë¡ íŠ¸ì—”ë“œì— ë°˜í™˜í•˜ê¸°
    """

    # ğŸ’¡ ë°ì´í„° ìœ íš¨ì„± í™•ì¸ (Residents.csv)
    residents_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/Residents.csv')
    if patient_id not in residents_df['ResidentID'].values:
        raise ValueError(f"Patient ID {patient_id}ê°€ Residents.csvì— ì—†ìŠµë‹ˆë‹¤")

    # 1. ì ìˆ˜ ê³„ì‚°
    personality_scores = calculate_personality_scores(answers)

    # 2. ğŸ“Š PatientPersonality í…Œì´ë¸”ì— ì €ì¥
    saved_profile = save_patient_personality(patient_id, personality_scores)

    # 3. ì‘ë‹µ (í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë Œë”ë§í•  ë°ì´í„°)
    return {
        'success': True,
        'personality_type': saved_profile.PersonalityType,
        'scores': {
            'empathy': saved_profile.EmpathyScore,
            'activity': saved_profile.ActivityScore,
            'patience': saved_profile.PatienceRequiredScore,
            'independence': saved_profile.IndependenceScore,
        },
        'description': saved_profile.PersonalityDescription,
        'radar_chart_data': {
            'labels': ['ê³µê° ìš”êµ¬', 'í™œë™ì„±', 'ì¸ë‚´ì‹¬ í•„ìš”', 'ë…ë¦½ì„±'],
            'datasets': [{
                'label': 'ë‹¹ì‹ ì˜ ì„±í–¥',
                'data': [
                    saved_profile.EmpathyScore,
                    saved_profile.ActivityScore,
                    saved_profile.PatienceRequiredScore,
                    saved_profile.IndependenceScore
                ],
                'backgroundColor': 'rgba(200, 230, 201, 0.3)',
                'borderColor': 'rgba(76, 175, 80, 1)'
            }]
        }
    }
```

**í”„ë¡ íŠ¸ì—”ë“œ (React)**:
```jsx
import { Radar } from 'react-chartjs-2';

function PersonalityResultScreen({ apiResponse }) {
  return (
    <div className="result-container">
      <h1>ë‹¹ì‹ ì€ {apiResponse.personality_type}ì…ë‹ˆë‹¤ ğŸ’™</h1>
      <Radar data={apiResponse.radar_chart_data} />
      <p>{apiResponse.description}</p>
      <button>í”„ë¡œí•„ì— ì €ì¥</button>
    </div>
  );
}
```

---

### 2ï¸âƒ£ ê°„ë³‘ì¸ íƒìƒ‰ & í•„í„°ë§

**ì‚¬ìš© ë°ì´í„°**: `PersonalityBasedCandidates`, `Caregivers`, `CaregiverStyle`

```python
@app.get("/api/caregivers/recommended")
async def get_recommended_caregivers(
    patient_id: int,
    region: str = None,
    job_title: str = None,
    limit: int = 10
):
    """
    í™˜ìì˜ ì„±í–¥ì— ë§ëŠ” ê°„ë³‘ì¸ ìƒìœ„ Nëª… ì¶”ì²œ

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - Residents.csv (í™˜ì ì •ë³´ ê¸°ë³¸ê°’)
    - staff.csv (ê°„ë³‘ì¸ ëª©ë¡ & í•„í„°ë§)
    - medications.csv (ì•½ë¬¼ ì •ë³´ - medical_fit ê³„ì‚°ìš©)

    ğŸ“Š ì½ê¸° í…Œì´ë¸”:
    - PatientPersonality (í™˜ì ì„±í–¥ ì ìˆ˜)
    - Caregivers (ë˜ëŠ” staff.csv - ê°„ë³‘ì¸ í”„ë¡œí•„)
    - CaregiverStyle (ê°„ë³‘ì¸ ëŒë´„ ìŠ¤íƒ€ì¼ ì ìˆ˜)
    - Review (ë¦¬ë·° í‰ì )

    ğŸ“Š ì €ì¥ í…Œì´ë¸”:
    - PersonalityBasedCandidates (ì¶”ì²œ ê²°ê³¼)
    """

    # ğŸ’¡ ë°ì´í„° ìœ íš¨ì„± í™•ì¸
    residents_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/Residents.csv')
    staff_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/staff.csv')

    if patient_id not in residents_df['ResidentID'].values:
        raise ValueError(f"Patient ID {patient_id}ê°€ Residents.csvì— ì—†ìŠµë‹ˆë‹¤")

    # 1. ğŸ“Š í™˜ìì˜ ì„±í–¥ ì¡°íšŒ (PatientPersonality í…Œì´ë¸”)
    patient_personality = db.query(PatientPersonality).filter(
        PatientPersonality.PatientID == patient_id
    ).first()

    # 2. ê¸°ë³¸ í•„í„° ì¡°ê±´ (ì§€ì—­, ì§ê¸‰) - Caregivers í…Œì´ë¸” ë˜ëŠ” staff.csv ì‚¬ìš©
    query = db.query(Caregivers).filter(
        Caregivers.Status == 'Active'
    )

    if region:
        query = query.filter(Caregivers.Region == region)
    if job_title:
        query = query.filter(Caregivers.JobTitle == job_title)

    caregivers = query.all()

    # 3. ê° ê°„ë³‘ì¸ê³¼ì˜ í˜¸í™˜ë„ ê³„ì‚°
    candidates = []
    for caregiver in caregivers:
        # ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ ì¡°íšŒ (ë˜ëŠ” ê³„ì‚°)
        caregiver_style = db.query(CaregiverStyle).filter(
            CaregiverStyle.CaregiverID == caregiver.CaregiverID
        ).first()

        if not caregiver_style:
            # ìŠ¤íƒ€ì¼ì´ ì—†ìœ¼ë©´ ê³„ì‚°
            caregiver_style_dict = calculate_caregiver_style_score(
                caregiver.CaregiverID
            )
        else:
            caregiver_style_dict = {
                'empathy_score': caregiver_style.EmpathyScore,
                'activity_score': caregiver_style.ActivityScore,
                'patience_score': caregiver_style.PatienceScore,
                'independence_support_score': caregiver_style.IndependenceSupportScore
            }

        # í˜¸í™˜ë„ ê³„ì‚°
        personality_patient_dict = {
            'empathy': patient_personality.EmpathyScore,
            'activity': patient_personality.ActivityScore,
            'patience': patient_personality.PatienceRequiredScore,
            'independence': patient_personality.IndependenceScore
        }

        compatibility = calculate_personality_compatibility(
            personality_patient_dict,
            caregiver_style_dict
        )

        # ì˜ë£Œ í•„ìš”ë„ ì í•©ì„± ì¶”ê°€ (ê¸°ì¡´ ì•Œê³ ë¦¬ì¦˜)
        medical_fit = calculate_medical_necessity_fit(
            patient_id,
            caregiver.CaregiverID
        )

        # ìµœì¢… ì ìˆ˜ = ì˜ë£Œí•„ìš”ë„(40%) + ì„±í–¥í˜¸í™˜ë„(60%)
        final_score = (medical_fit * 0.40) + (compatibility['overall_compatibility'] * 0.60)

        candidates.append({
            'caregiver_id': caregiver.CaregiverID,
            'name': caregiver.Name,
            'region': caregiver.Region,
            'job_title': caregiver.JobTitle,
            'profile_image': caregiver.ProfileImageURL,
            'final_score': round(final_score, 1),
            'personality_fit': round(compatibility['overall_compatibility'], 1),
            'medical_fit': round(medical_fit, 1),
            'review_rating': caregiver.AverageRating,
            'review_count': caregiver.ReviewCount,
            'matching_reason': f"ë‹¹ì‹ ê³¼ ì„±í–¥ì´ {round(compatibility['overall_compatibility'])}% ì¼ì¹˜í•©ë‹ˆë‹¤ ğŸ’«"
        })

    # 4. ì ìˆ˜ ìˆœ ì •ë ¬ & ìƒìœ„ Nëª… ë°˜í™˜
    candidates.sort(key=lambda x: x['final_score'], reverse=True)

    return {
        'candidates': candidates[:limit],
        'total_count': len(candidates)
    }
```

**í”„ë¡ íŠ¸ì—”ë“œ (React)**:
```jsx
function CaregiverListScreen({ candidates }) {
  return (
    <div className="caregiver-list">
      {candidates.map(caregiver => (
        <div className="caregiver-card" key={caregiver.caregiver_id}>
          <img src={caregiver.profile_image} />
          <h3>{caregiver.name}</h3>
          <p>{caregiver.job_title} | {caregiver.region}</p>
          <p className="matching-score">
            ğŸ’« {caregiver.matching_reason}
          </p>
          <div className="rating">
            â­ {caregiver.review_rating} ({caregiver.review_count})
          </div>
          <button>ìì„¸íˆ ë³´ê¸°</button>
        </div>
      ))}
    </div>
  );
}
```

---

### 3ï¸âƒ£ ê°„ë³‘ì¸ ìƒì„¸ í”„ë¡œí•„

**ì‚¬ìš© ë°ì´í„°**: `staff.csv`, `Caregivers`, `CaregiverStyle`, `Review`, `PersonalityBasedCandidates`

```python
@app.get("/api/caregivers/{caregiver_id}/profile")
async def get_caregiver_profile(
    patient_id: int,
    caregiver_id: int
):
    """
    ê°„ë³‘ì¸ ìƒì„¸ í”„ë¡œí•„ + AI ì¶”ì²œ ì´ìœ 

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - staff.csv (ê°„ë³‘ì¸ ê¸°ë³¸ ì •ë³´)
    - medications.csv (ì•½ë¬¼ ê²½í—˜ë„ - ê²½ë ¥ ê³„ì‚°ìš©)

    ğŸ“Š ì½ê¸° í…Œì´ë¸”:
    - Caregivers (ë˜ëŠ” staff.csv - ê°„ë³‘ì¸ í”„ë¡œí•„)
    - CaregiverStyle (ê°„ë³‘ì¸ 4ì¶• ìŠ¤íƒ€ì¼ ì ìˆ˜)
    - Review (ì´ì „ í™˜ì ë¦¬ë·° & í‰ì )
    - PersonalityBasedCandidates (ì¶”ì²œ ì´ìœ  & í˜¸í™˜ë„)
    """

    # ğŸ’¡ ê°„ë³‘ì¸ ë°ì´í„° í™•ì¸
    staff_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/staff.csv')
    if caregiver_id not in staff_df['StaffID'].values:
        raise ValueError(f"Caregiver ID {caregiver_id}ê°€ staff.csvì— ì—†ìŠµë‹ˆë‹¤")

    # ğŸ“Š Caregivers í…Œì´ë¸”ì—ì„œ ì¡°íšŒ (ë˜ëŠ” staff.csv)
    caregiver = db.query(Caregivers).filter(
        Caregivers.CaregiverID == caregiver_id
    ).first()

    # ğŸ“Š CaregiverStyle í…Œì´ë¸”ì—ì„œ ì¡°íšŒ
    caregiver_style = db.query(CaregiverStyle).filter(
        CaregiverStyle.CaregiverID == caregiver_id
    ).first()

    # ğŸ“Š Review í…Œì´ë¸”ì—ì„œ ì´ì „ ë¦¬ë·° ì¡°íšŒ
    reviews = db.query(Review).filter(
        Review.CaregiverID == caregiver_id
    ).order_by(Review.CreatedAt.desc()).limit(5).all()

    # ğŸ“Š PersonalityBasedCandidates í…Œì´ë¸”ì—ì„œ ì¶”ì²œ ì´ìœ  ì¡°íšŒ
    candidate = db.query(PersonalityBasedCandidates).filter(
        PersonalityBasedCandidates.PatientID == patient_id,
        PersonalityBasedCandidates.CaregiverID == caregiver_id
    ).first()

    return {
        'profile': {
            'caregiver_id': caregiver.CaregiverID,
            'name': caregiver.Name,
            'age': calculate_age(caregiver.DateOfBirth),
            'gender': caregiver.Gender,
            'job_title': caregiver.JobTitle,
            'region': caregiver.Region,
            'profile_image': caregiver.ProfileImageURL,
            'bio': caregiver.Bio,
            'years_experience': calculate_years_experience(caregiver.EmploymentDate)
        },
        'care_style': {
            'empathy': caregiver_style.EmpathyScore,
            'activity': caregiver_style.ActivityScore,
            'patience': caregiver_style.PatienceScore,
            'independence_support': caregiver_style.IndependenceSupportScore,
            'description': get_style_description(caregiver_style)
        },
        'reviews': [
            {
                'rating': review.Rating,
                'content': review.Content,
                'date': review.CreatedAt.strftime('%Y-%m-%d')
            }
            for review in reviews
        ],
        'matching_analysis': {
            'overall_fit': candidate.FinalScore if candidate else None,
            'personality_fit': candidate.PersonalityFitScore if candidate else None,
            'ai_reason': candidate.MatchingReasonAI if candidate else None,
            'empathy_match': candidate.EmpathyCompatibility if candidate else None,
            'activity_match': candidate.ActivityCompatibility if candidate else None,
            'patience_match': candidate.PatienceCompatibility if candidate else None,
            'independence_match': candidate.IndependenceCompatibility if candidate else None
        }
    }

def get_style_description(caregiver_style) -> dict:
    """
    ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ì„ í…ìŠ¤íŠ¸ë¡œ ì„¤ëª…
    """
    descriptions = {
        'empathy': {
            'high': 'ê°ì •ì ìœ¼ë¡œ ê¹Šì´ ìˆê³  ë”°ëœ»í•œ ê³µê°',
            'mid': 'ì ì ˆí•œ ê°ì • ì§€ì§€',
            'low': 'ì „ë¬¸ì ì´ê³  ê°ê´€ì ì¸ ì ‘ê·¼'
        },
        'activity': {
            'high': 'í™œë™ì ì´ê³  ìê·¹ ë§ì€ ìŠ¤íƒ€ì¼',
            'mid': 'ê· í˜•ì¡íŒ í™œë™ëŸ‰',
            'low': 'ì°¨ë¶„í•˜ê³  ì•ˆì •ì ì¸ í™˜ê²½ ì¤‘ì‹¬'
        },
        'patience': {
            'high': 'ë§¤ìš° ì¸ë‚´ì‹¬ ìˆê³  ë°˜ë³µ ì„¤ëª… ê°€ëŠ¥',
            'mid': 'ì¼ë°˜ì ì¸ ì¸ë‚´ì‹¬ ìˆ˜ì¤€',
            'low': 'ë¹ ë¥´ê³  íš¨ìœ¨ì ì¸ ì§„í–‰'
        },
        'independence': {
            'high': 'ìë¦½ì„±ì„ ìµœëŒ€í•œ ì¡´ì¤‘',
            'mid': 'í•„ìš”ì‹œì—ë§Œ ê°œì…',
            'low': 'ì„¸ì‹¬í•œ ê´€ë¦¬ì™€ ìì£¼ ë„ì›€'
        }
    }

    return {
        'empathy': get_level_description(caregiver_style.EmpathyScore, 'empathy'),
        'activity': get_level_description(caregiver_style.ActivityScore, 'activity'),
        'patience': get_level_description(caregiver_style.PatienceScore, 'patience'),
        'independence': get_level_description(caregiver_style.IndependenceSupportScore, 'independence')
    }

def get_level_description(score: float, dimension: str) -> str:
    """ì ìˆ˜ë¥¼ í…ìŠ¤íŠ¸ ì„¤ëª…ìœ¼ë¡œ ë³€í™˜"""
    level = 'high' if score > 70 else ('mid' if score > 40 else 'low')
    descriptions = {...}  # ìœ„ì˜ descriptions ë”•ì…”ë„ˆë¦¬
    return descriptions[dimension][level]
```

---

### 4ï¸âƒ£ ì¼ì • & ë¦¬í¬íŠ¸

**ì‚¬ìš© ë°ì´í„°**: `Residents.csv`, `staff.csv`, `PersonalityBasedMatching`, `CareLog`, `IoTMetrics`

```python
@app.get("/api/reports/daily/{matching_id}")
async def get_daily_report(matching_id: int, date: str):
    """
    íŠ¹ì • ë§¤ì¹­ì˜ ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - Residents.csv (í™˜ì ì •ë³´)
    - staff.csv (ê°„ë³‘ì¸ ì •ë³´)

    ğŸ“Š ì½ê¸° í…Œì´ë¸”:
    - PersonalityBasedMatching (ë§¤ì¹­ ì •ë³´)
    - CareLog (ê°„ë³‘ì¸ì˜ ì¼ì¼ ì¼€ì–´ ê¸°ë¡ & ë…¸íŠ¸)
    - IoTMetrics (ì›¨ì–´ëŸ¬ë¸” ê¸°ê¸° ê±´ê°• ì§€í‘œ)
    - PatientPersonality (í™˜ì ì„±í–¥ - ë¦¬í¬íŠ¸ ë§¥ë½ìš©)
    - CaregiverStyle (ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ - ë¦¬í¬íŠ¸ ë§¥ë½ìš©)
    """

    # ğŸ’¡ ë°ì´í„° ìœ íš¨ì„± í™•ì¸
    residents_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/Residents.csv')
    staff_df = pd.read_csv('/Users/sangwon/Project/Sesac_class/bluedonulab-01/staff.csv')

    # ğŸ“Š ë§¤ì¹­ ì •ë³´ ì¡°íšŒ
    matching = db.query(PersonalityBasedMatching).filter(
        PersonalityBasedMatching.MatchingID == matching_id
    ).first()

    if matching:
        if matching.PatientID not in residents_df['ResidentID'].values:
            raise ValueError(f"Patient ID {matching.PatientID}ê°€ Residents.csvì— ì—†ìŠµë‹ˆë‹¤")
        if matching.CaregiverID not in staff_df['StaffID'].values:
            raise ValueError(f"Caregiver ID {matching.CaregiverID}ê°€ staff.csvì— ì—†ìŠµë‹ˆë‹¤")

    # ğŸ“Š ì¼€ì–´ ê¸°ë¡ ì¡°íšŒ (ê°„ë³‘ì¸ì´ ì‘ì„±í•œ ì¼ì¼ ë…¸íŠ¸)
    care_logs = db.query(CareLog).filter(
        CareLog.MatchingID == matching_id,
        CareLog.CareDate == datetime.strptime(date, '%Y-%m-%d').date()
    ).all()

    # ğŸ“Š IoT ë©”íŠ¸ë¦­ ì¡°íšŒ (ì›¨ì–´ëŸ¬ë¸” ê¸°ê¸° ê±´ê°• ì§€í‘œ)
    iot_data = db.query(IoTMetrics).filter(
        IoTMetrics.PatientID == matching.PatientID,
        IoTMetrics.MeasurementDate == datetime.strptime(date, '%Y-%m-%d').date()
    ).all()

    # AI ë¦¬í¬íŠ¸ ìƒì„±
    report_content = generate_ai_daily_report(
        matching=matching,
        care_logs=care_logs,
        iot_data=iot_data
    )

    return {
        'date': date,
        'caregiver_name': matching.caregiver.Name,
        'summary': report_content['summary'],  # AI ìƒì„±: "ì˜¤ëŠ˜ë„ ë¯¸ì†Œê°€ ë§ì•˜ìŠµë‹ˆë‹¤ ğŸ˜Š"
        'health_status': analyze_health_status(iot_data),
        'activity_level': calculate_activity_percentage(care_logs),
        'meal_intake': summarize_meal_intake(care_logs),
        'mood': extract_mood(care_logs, iot_data),
        'metrics': {
            'body_temp': get_latest_metric(iot_data, 'body_temperature'),
            'heart_rate': get_latest_metric(iot_data, 'heart_rate'),
            'blood_pressure': get_latest_metric(iot_data, 'blood_pressure')
        },
        'caregiver_notes': compile_caregiver_notes(care_logs),
        'suggestions': generate_suggestions(matching, care_logs, iot_data)
    }

def generate_ai_daily_report(matching, care_logs, iot_data) -> dict:
    """
    ì¼€ì–´ ê¸°ë¡ + IoT ë°ì´í„° â†’ AI ê¸°ë°˜ ìì—°ì–´ ë¦¬í¬íŠ¸ ìƒì„±
    """

    prompt = f"""
    ë‹¹ì‹ ì€ BluedonuLab ê°„ë³‘ ì„œë¹„ìŠ¤ì˜ ë¦¬í¬íŠ¸ ìƒì„± AIì…ë‹ˆë‹¤.
    í™˜ìì˜ ê°€ì¡±ì´ ì½ì„ ìˆ˜ ìˆë„ë¡ ë”°ëœ»í•˜ê³  ì´í•´í•˜ê¸° ì‰¬ìš´ ë¦¬í¬íŠ¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

    í™˜ì ì •ë³´:
    - ì„±í–¥: {matching.patient.personality.PersonalityType}
    - ì¼€ì–´ ìˆ˜ì¤€: {matching.patient.CareLevel}

    ê°„ë³‘ì¸ ì •ë³´:
    - ì´ë¦„: {matching.caregiver.Name}
    - ëŒë´„ ìŠ¤íƒ€ì¼: {matching.caregiver.style.description}

    ì˜¤ëŠ˜ì˜ ì¼€ì–´:
    {format_care_logs(care_logs)}

    ê±´ê°• ì§€í‘œ:
    {format_iot_data(iot_data)}

    ìš”ì²­:
    1. ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ í•œ ë¬¸ì¥(ì´ëª¨ì§€ í¬í•¨)ìœ¼ë¡œ ìš”ì•½í•´ì£¼ì„¸ìš”
    2. í™˜ìì˜ ê±´ê°• ìƒíƒœë¥¼ í‰ê°€í•´ì£¼ì„¸ìš” (ì•ˆì •ì /ì£¼ì˜/ìœ„í—˜)
    3. ê°„ë³‘ì¸ì˜ ë…¸ë ¥ì„ ê¸ì •ì ìœ¼ë¡œ í‘œí˜„í•´ì£¼ì„¸ìš”
    4. íŠ¹ë³„í•œ ì£¼ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´ ì–¸ê¸‰í•´ì£¼ì„¸ìš”

    í˜•ì‹:
    {{
        "summary": "í•œ ë¬¸ì¥ ìš”ì•½",
        "health_assessment": "ì•ˆì •ì /ì£¼ì˜/ìœ„í—˜",
        "highlights": ["ê°•ì  1", "ê°•ì  2"],
        "notes": "íŠ¹ì´ì‚¬í•­ ë˜ëŠ” ì œì•ˆ"
    }}
    """

    response = azure_openai_call(prompt)
    return json.loads(response)
```

---

## ë°ì´í„° ì „ì²˜ë¦¬ & ì •ê·œí™”

### 1ï¸âƒ£ ê²°ì¸¡ì¹˜ ì²˜ë¦¬

```python
import pandas as pd

def handle_missing_values(df: pd.DataFrame, source_file: str = None) -> pd.DataFrame:
    """
    CAREHOME ë°ì´í„°ì…‹ì˜ ê²°ì¸¡ì¹˜ ì²˜ë¦¬
    íŠ¹íˆ medications.csvì˜ Dosage 3% ê²°ì¸¡ì¹˜

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - medications.csv (ì•½ë¬¼ ìš©ëŸ‰ ì •ë³´)
    - Residents.csv (í™˜ì ê¸°ë³¸ ì •ë³´)
    - staff.csv (ê°„ë³‘ì¸ ê¸°ë³¸ ì •ë³´)

    ğŸ’¡ ê° íŒŒì¼ë³„ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ì „ëµ:
    - medications.csv: Dosage ê²°ì¸¡ì¹˜ â†’ ì•½ë¬¼ë³„ ì¤‘ì•™ê°’ìœ¼ë¡œ ëŒ€ì²´
    - Residents.csv: Gender ê²°ì¸¡ì¹˜ â†’ 'Unknown'ìœ¼ë¡œ ëŒ€ì²´
    - staff.csv: Bio ê²°ì¸¡ì¹˜ â†’ ë¹ˆ ë¬¸ìì—´ë¡œ ëŒ€ì²´
    """

    if source_file == 'medications' or 'Dosage' in df.columns:
        # ğŸ“ medications.csv ì²˜ë¦¬
        # 1. Medications í…Œì´ë¸”ì˜ Dosage ê²°ì¸¡ì¹˜
        # â†’ ê° ì•½ë¬¼ë³„ ì¤‘ì•™ê°’(Median)ìœ¼ë¡œ ëŒ€ì²´
        for medication in df['Medication Name'].unique():
            mask = (df['Medication Name'] == medication) & (df['Dosage'].isna())
            median_dosage = df[df['Medication Name'] == medication]['Dosage'].median()
            df.loc[mask, 'Dosage'] = median_dosage
            # ğŸ’¡ ì˜ˆ: Metforminì˜ í‰ê·  Dosage: 250mg â†’ ê²°ì¸¡ì¹˜ë¥¼ 250mgìœ¼ë¡œ ëŒ€ì²´

    if source_file == 'residents' or 'Gender' in df.columns:
        # ğŸ“ Residents.csv ì²˜ë¦¬
        # 2. Residents í…Œì´ë¸”ì˜ ì„ íƒì  í•„ë“œ ì²˜ë¦¬
        df['Gender'].fillna('Unknown', inplace=True)

    if source_file == 'staff' or 'Bio' in df.columns:
        # ğŸ“ staff.csv ì²˜ë¦¬
        # 3. Staff í…Œì´ë¸”ì˜ Bio í•„ë“œ ì²˜ë¦¬
        df['Bio'].fillna('', inplace=True)

    return df

# ì˜ˆì‹œ ì‚¬ìš©:
# medications_df = pd.read_csv('medications.csv')
# medications_df = handle_missing_values(medications_df, source_file='medications')
#
# residents_df = pd.read_csv('Residents.csv')
# residents_df = handle_missing_values(residents_df, source_file='residents')
```

### 2ï¸âƒ£ ì´ìƒì¹˜ íƒì§€ & ì œê±°

```python
import pandas as pd

def detect_and_handle_outliers(df: pd.DataFrame, column: str, method='iqr', source_file: str = None) -> pd.DataFrame:
    """
    IQR(Interquartile Range) ë°©ì‹ìœ¼ë¡œ ì´ìƒì¹˜ íƒì§€

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - healthcare_dataset.csv (ë‚˜ì´ > 200ì„¸ ê°™ì€ ì´ìƒì¹˜ í¬í•¨)
    - Residents.csv (ë‚˜ì´ ë²”ìœ„ ê²€ì¦ìš©)
    - medications.csv (ì•½ë¬¼ ìš©ëŸ‰ ë²”ìœ„ ê²€ì¦ìš©)

    ğŸ’¡ íŒŒì¼ë³„ ì£¼ìš” ì´ìƒì¹˜ ì‚¬ë¡€:
    - healthcare_dataset.csv: Age > 150 ë˜ëŠ” < 0
    - medications.csv: Dosage ìŒìˆ˜ê°’ ë˜ëŠ” ê·¹ë„ë¡œ í° ê°’
    - Residents.csv: ë¯¸ë˜ ë‚ ì§œì˜ BirthDate
    """

    if method == 'iqr':
        Q1 = df[column].quantile(0.25)
        Q3 = df[column].quantile(0.75)
        IQR = Q3 - Q1

        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR

        # ì´ìƒì¹˜ ë ˆì½”ë“œ ì‹ë³„
        outliers = df[(df[column] < lower_bound) | (df[column] > upper_bound)]

        print(f"[{source_file or 'Unknown'}] {column} ì´ìƒì¹˜ ê°ì§€: {len(outliers)}ê°œ")
        print(f"  ë²”ìœ„: {lower_bound:.2f} ~ {upper_bound:.2f}")

        # ì œê±° ë˜ëŠ” ë³´ì •
        # ì˜µì…˜ 1: ì œê±° (ì¶”ì²œ)
        df = df[(df[column] >= lower_bound) & (df[column] <= upper_bound)]

        # ì˜µì…˜ 2: ë³´ì • (ê²½ê³„ê°’ìœ¼ë¡œ ì¡°ì •)
        # df.loc[df[column] < lower_bound, column] = lower_bound
        # df.loc[df[column] > upper_bound, column] = upper_bound

        print(f"  ì²˜ë¦¬ í›„ í–‰ ìˆ˜: {len(df)}ê°œ")

    return df

# ì˜ˆì‹œ 1 - healthcare_dataset.csv:
# Age ì»¬ëŸ¼: Q1=50, Q3=80, IQR=30
# lower_bound = 50 - 1.5*30 = 5
# upper_bound = 80 + 1.5*30 = 125
# â†’ 5ì„¸ ë¯¸ë§Œ ë˜ëŠ” 125ì„¸ ì´ìƒì€ ì´ìƒì¹˜ë¡œ ê°„ì£¼

# ì˜ˆì‹œ 2 - medications.csv:
# Dosage ì»¬ëŸ¼: Q1=100, Q3=500, IQR=400
# lower_bound = 100 - 1.5*400 = -500 (ìŒìˆ˜ëŠ” ë¶ˆê°€ëŠ¥)
# upper_bound = 500 + 1.5*400 = 1100
# â†’ Dosageê°€ 0 ì´ìƒ 1100 ì´í•˜ ë²”ìœ„ í™•ì¸
```

### 3ï¸âƒ£ ì •ê·œí™” (Normalization)

```python
import pandas as pd
from sklearn.preprocessing import MinMaxScaler, StandardScaler

def normalize_features(df: pd.DataFrame, columns: list, source_file: str = None) -> pd.DataFrame:
    """
    Min-Max Normalization: ëª¨ë“  ê°’ì„ 0~1 ë²”ìœ„ë¡œ ë³€í™˜

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - healthcare_dataset.csv (ë‚˜ì´, ì²­êµ¬ ê¸ˆì•¡ ì •ê·œí™”)
    - HomeHealthCare-StatebyStateData.csv (ì§€ì—­ë³„ KPI ì •ê·œí™”)
    - medications.csv (ì•½ë¬¼ ìš©ëŸ‰ ë²”ìœ„ ì •ê·œí™”)
    - staff.csv (ê²½ë ¥ ë…„ìˆ˜ ì •ê·œí™”)

    ğŸ’¡ ì •ê·œí™” ëª©ì :
    - ì„œë¡œ ë‹¤ë¥¸ ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ 0~1 ë²”ìœ„ë¡œ í†µì¼
    - ì˜ˆ: ë‚˜ì´(18~100)ì™€ ê¸‰ì—¬($30K~$150K)ë¥¼ ê°™ì€ ìŠ¤ì¼€ì¼ë¡œ ë¹„êµ
    - BluedonuLabì—ì„œëŠ” ì„±í–¥ ì ìˆ˜(0~100)ë¥¼ ëª¨ë‘ ì´ ë°©ì‹ìœ¼ë¡œ ì •ê·œí™”
    """

    scaler = MinMaxScaler()
    df[columns] = scaler.fit_transform(df[columns])

    print(f"[{source_file or 'Unknown'}] Min-Max ì •ê·œí™” ì™„ë£Œ: {len(columns)}ê°œ ì»¬ëŸ¼")

    return df

def standardize_features(df: pd.DataFrame, columns: list, source_file: str = None) -> pd.DataFrame:
    """
    Standard Scaler: í‰ê·  0, í‘œì¤€í¸ì°¨ 1ì˜ ë¶„í¬ë¡œ ë³€í™˜

    ğŸ’¡ ì–¸ì œ ì‚¬ìš©í•˜ëŠ”ê°€?
    - ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ ì‹œ (KNN, ì„ í˜•íšŒê·€ ë“±)
    - í†µê³„ ë¶„ì„ ì‹œ (t-test, ANOVA ë“±)
    - BluedonuLabì—ì„œëŠ” í‰ê·  ê¸°ë°˜ ë¶„ì„ ì‹œ ì‚¬ìš©
    """

    scaler = StandardScaler()
    df[columns] = scaler.fit_transform(df[columns])

    print(f"[{source_file or 'Unknown'}] Standard ì •ê·œí™” ì™„ë£Œ: {len(columns)}ê°œ ì»¬ëŸ¼")

    return df

# ì˜ˆì‹œ 1 - healthcare_dataset.csv:
# Age: 18~100 â†’ 0~1
# Billing Amount: $1,000~$50,000 â†’ 0~1
#
# ê³„ì‚° ê³µì‹:
# normalized_value = (value - min) / (max - min)
#
# Age ì˜ˆì‹œ:
# - ìµœì†Œê°’(min): 18, ìµœëŒ€ê°’(max): 100
# - 30ì„¸ì¸ ê²½ìš°: (30 - 18) / (100 - 18) = 12/82 â‰ˆ 0.146
# - 50ì„¸ì¸ ê²½ìš°: (50 - 18) / (100 - 18) = 32/82 â‰ˆ 0.390
# - 100ì„¸ì¸ ê²½ìš°: (100 - 18) / (100 - 18) = 82/82 = 1.0

# ì˜ˆì‹œ 2 - medications.csv:
# Dosage: 50~2000 â†’ 0~1
# - ì•½ë¬¼ë³„ë¡œ ë‹¤ë¥¸ ë²”ìœ„ë¥¼ 0~1ë¡œ í†µì¼
# - ë‚˜ì¤‘ì— ì„±í–¥ ì ìˆ˜ì™€ ë¹„êµ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¦
```

---

## AI í†µí•© í™œìš©

> **ğŸ’¡ ì£¼ì„**:
> BluedonuLabì€ Azure OpenAIë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤:
> - ğŸ“ ì…ë ¥: PatientPersonality, CaregiverStyle í…Œì´ë¸”ì˜ ì ìˆ˜
> - ğŸ¤– ì²˜ë¦¬: Azure OpenAI (GPT-4 ëª¨ë¸)
> - ğŸ“¤ ì¶œë ¥: ìì—°ì–´ ì„¤ëª… & ì¶”ì²œ ì´ìœ  ë¬¸ì¥
> - ğŸ’¾ ì €ì¥: PatientPersonality, PersonalityBasedCandidates í…Œì´ë¸”

### 1ï¸âƒ£ ì„±í–¥ ì„¤ëª… ìƒì„±

ì´ë¯¸ ìœ„ì—ì„œ ë‹¤ë£¬ `generate_ai_description()` ì°¸ê³ 

**ë°ì´í„° íë¦„**:
1. ğŸ“Š PatientPersonality í…Œì´ë¸”ì—ì„œ ì ìˆ˜ ì½ê¸°
2. ğŸ¤– Azure OpenAIì— í”„ë¡¬í”„íŠ¸ ì „ì†¡
3. ğŸ“¤ AI ìƒì„± ì„¤ëª… ë°›ê¸°
4. ğŸ’¾ PersonalityDescription ì»¬ëŸ¼ì— ì €ì¥

### 2ï¸âƒ£ ë§¤ì¹­ ì´ìœ  ìƒì„±

```python
from azure.ai.openai import OpenAIClient

def generate_matching_reason(
    patient_personality: dict,
    caregiver_style: dict,
    compatibility_score: float,
    patient_id: int = None,
    caregiver_id: int = None
) -> str:
    """
    í™˜ì-ê°„ë³‘ì¸ ë§¤ì¹­ì˜ ì´ìœ ë¥¼ AIê°€ ìì—°ì–´ë¡œ ì„¤ëª…

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - Residents.csv (í™˜ì ê¸°ë³¸ ì •ë³´ - ë§¥ë½ìš©)
    - staff.csv (ê°„ë³‘ì¸ ê¸°ë³¸ ì •ë³´ - ë§¥ë½ìš©)

    ğŸ“Š ì½ê¸° í…Œì´ë¸”:
    - PatientPersonality (í™˜ì ì„±í–¥ ì ìˆ˜)
    - CaregiverStyle (ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼ ì ìˆ˜)
    - Review (ì´ì „ ë§¤ì¹­ ì‚¬ë¡€ - ê²€ì¦ìš©)

    ğŸ“Š ì €ì¥ í…Œì´ë¸”:
    - PersonalityBasedCandidates (MatchingReasonAI ì»¬ëŸ¼)

    ğŸ’¡ AI ìƒì„± í…ìŠ¤íŠ¸ëŠ” PersonalityBasedCandidates í…Œì´ë¸”ì˜
       MatchingReasonAI ì»¬ëŸ¼ì— ì €ì¥ë˜ì–´ UIì—ì„œ í‘œì‹œë¨
    """

    prompt = f"""
    ë‹¹ì‹ ì€ BluedonuLabì˜ ë§¤ì¹­ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.
    í™˜ìì™€ ê°„ë³‘ì¸ì˜ ì„±í–¥ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë”°ëœ»í•˜ê³  ì„¤ë“ë ¥ ìˆëŠ” ì´ìœ ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.

    í™˜ì ì„±í–¥:
    - ê³µê° ìš”êµ¬: {patient_personality['empathy']}/100
    - í™œë™ì„±: {patient_personality['activity']}/100
    - ì¸ë‚´ì‹¬ í•„ìš”: {patient_personality['patience']}/100
    - ë…ë¦½ì„±: {patient_personality['independence']}/100

    ê°„ë³‘ì¸ ìŠ¤íƒ€ì¼:
    - ê³µê°ë ¥: {caregiver_style['empathy_score']}/100
    - í™œë™ì„±: {caregiver_style['activity_score']}/100
    - ì¸ë‚´ì‹¬: {caregiver_style['patience_score']}/100
    - ë…ë¦½ì„± ì¡´ì¤‘: {caregiver_style['independence_support_score']}/100

    ë§¤ì¹­ í˜¸í™˜ë„: {compatibility_score}%

    ìš”ì²­:
    1. í™˜ìë¥¼ ë¨¼ì € ì„¤ëª… (í™˜ìì˜ ì„±í–¥ íƒ€ì…)
    2. ê°„ë³‘ì¸ì˜ ê°•ì ì„ ì„¤ëª…
    3. ì™œ ì´ë“¤ì´ ì˜ ë§ëŠ”ì§€ ì„¤ëª…
    4. ë¹„ìŠ·í•œ ì„±í–¥ì˜ ë‹¤ë¥¸ í™˜ìë“¤ë„ ë§Œì¡±í–ˆë‹¤ê³  ì–¸ê¸‰
    5. 1~2ë¬¸ì¥, ìµœëŒ€ 100ë‹¨ì–´
    6. ì´ëª¨ì§€ 1~2ê°œ í¬í•¨

    ì˜ˆì‹œ:
    "ë‹¹ì‹ ì€ ê°ì •ì  ì§€ì§€ê°€ ì¤‘ìš”í•˜ì‹ ë°,
    ê¹€OO ê°„ë³‘ì¸ì€ ê³µê° ëŠ¥ë ¥ì´ ë†’ì•„ ì˜ ë§ì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
    ë¹„ìŠ·í•œ ì„±í–¥ì˜ í™˜ìë“¤ì´ ë§Œì¡±í–ˆë˜ ë§¤ì¹­ì…ë‹ˆë‹¤. ğŸ’«"
    """

    # ğŸ¤– Azure OpenAI í˜¸ì¶œ
    response = azure_openai_call(prompt)

    # ğŸ’¾ ê²°ê³¼ë¥¼ PersonalityBasedCandidates í…Œì´ë¸”ì˜ MatchingReasonAIì— ì €ì¥
    return response
```

### 3ï¸âƒ£ ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±

ì´ë¯¸ ìœ„ì—ì„œ ë‹¤ë£¬ `generate_ai_daily_report()` ì°¸ê³ 

---

## ì„±ê³¼ ì§€í‘œ & ëª¨ë‹ˆí„°ë§

> **ğŸ’¡ ì£¼ì„**:
> KPI(Key Performance Indicator) ëª¨ë‹ˆí„°ë§ì€ **ì•Œê³ ë¦¬ì¦˜ì˜ ì •í™•ì„±ê³¼ ì„œë¹„ìŠ¤ í’ˆì§ˆ**ì„ í‰ê°€í•©ë‹ˆë‹¤.
> - ğŸ“Š ì…ë ¥ ë°ì´í„°: PersonalityBasedMatching í…Œì´ë¸” & HomeHealthCare-StatebyStateData.csv
> - ğŸ“Š ê³„ì‚°: ì™„ë£Œìœ¨, ë§Œì¡±ë„, í˜¸í™˜ë„ ê²€ì¦
> - ğŸ“Š ì¶œë ¥: ëŒ€ì‹œë³´ë“œìš© KPI ìˆ«ìë“¤

### 1ï¸âƒ£ ë§¤ì¹­ ì„±ê³¼ ì§€í‘œ

```python
from datetime import date, datetime, timedelta
import statistics

def calculate_matching_kpis(start_date: date, end_date: date) -> dict:
    """
    íŠ¹ì • ê¸°ê°„ì˜ ë§¤ì¹­ ì„±ê³¼ KPI ê³„ì‚°

    ğŸ“ ì‚¬ìš© íŒŒì¼:
    - HomeHealthCare-StatebyStateData.csv (ë²¤ì¹˜ë§ˆí¬ KPI)
    - Residents.csv (í™˜ì Care Levelë³„ ë¶„ì„ìš©)

    ğŸ“Š ì½ê¸° í…Œì´ë¸”:
    - PersonalityBasedMatching (ë§¤ì¹­ ê²°ê³¼ & ì ìˆ˜)
    - PatientSatisfaction (í™˜ì ë§Œì¡±ë„)
    - CaregiverPerformance (ê°„ë³‘ì¸ í‰ê°€)
    - PersonalityFitValidation (ì„±í–¥ ì˜ˆì¸¡ ê²€ì¦)

    ğŸ’¡ ê³„ì‚° ê²°ê³¼ëŠ” ê´€ë¦¬ ëŒ€ì‹œë³´ë“œì— í‘œì‹œë¨:
    - ì™„ë£Œìœ¨, í‰ê·  ì ìˆ˜, ë§Œì¡±ë„, ì„±í–¥ ì˜ˆì¸¡ ì •í™•ë„ ë“±
    """

    # ğŸ“Š ë§¤ì¹­ ë°ì´í„° ì¡°íšŒ
    matchings = db.query(PersonalityBasedMatching).filter(
        PersonalityBasedMatching.MatchingDate >= start_date,
        PersonalityBasedMatching.MatchingDate <= end_date
    ).all()

    completed_matchings = [m for m in matchings if m.Status == 'Completed']
    terminated_matchings = [m for m in matchings if m.Status == 'Terminated']

    return {
        'total_matchings': len(matchings),
        'completed_matchings': len(completed_matchings),
        'terminated_matchings': len(terminated_matchings),
        'completion_rate': (
            len(completed_matchings) / len(matchings) * 100
            if matchings else 0
        ),

        # ì ìˆ˜ ê¸°ë°˜ ì§€í‘œ
        'average_final_score': statistics.mean([m.FinalScore for m in matchings]) if matchings else 0,
        'average_personality_fit': statistics.mean([m.PersonalityFitScore for m in matchings]) if matchings else 0,
        'average_medical_fit': statistics.mean([m.MedicalFitScore for m in matchings]) if matchings else 0,

        # ë§Œì¡±ë„ ê¸°ë°˜ ì§€í‘œ
        'average_patient_satisfaction': statistics.mean([
            m.PatientSatisfaction for m in completed_matchings
            if m.PatientSatisfaction
        ]) if completed_matchings else 0,

        'average_caregiver_rating': statistics.mean([
            m.CaregiverPerformanceRating for m in completed_matchings
            if m.CaregiverPerformanceRating
        ]) if completed_matchings else 0,

        # ì„±í–¥ ì˜ˆì¸¡ ê²€ì¦
        'personality_fit_validation_rate': (
            len([m for m in completed_matchings
                 if m.PersonalityFitValidation >= 75]) /
            len(completed_matchings) * 100
            if completed_matchings else 0
        ),

        # Care Levelë³„ ì„±ê³¼
        'performance_by_care_level': calculate_performance_by_care_level(completed_matchings),

        # Job Titleë³„ ì„±ê³¼
        'performance_by_job_title': calculate_performance_by_job_title(completed_matchings)
    }

# ì˜ˆì‹œ ê²°ê³¼:
# {
#     'total_matchings': 150,
#     'completed_matchings': 135,
#     'completion_rate': 90.0,
#     'average_final_score': 78.5,
#     'average_personality_fit': 82.3,
#     'average_patient_satisfaction': 3.8,  # 5ì  ë§Œì 
#     'personality_fit_validation_rate': 88.0,  # ì˜ˆì¸¡í•œ í˜¸í™˜ë„ê°€ ì‹¤ì œì™€ ì¼ì¹˜í•œ ë¹„ìœ¨
#     ...
# }
```

### 2ï¸âƒ£ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ì¿¼ë¦¬

> **ğŸ’¡ ì£¼ì„**:
> ë‹¤ìŒ SQL ì¿¼ë¦¬ë“¤ì€ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œì— ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë  KPIë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
> ğŸ“Š ë°ì´í„° ì†ŒìŠ¤: PersonalityBasedMatching, PatientPersonality, CaregiverStyle í…Œì´ë¸”
> ğŸ“Š ì‚¬ìš© íŒŒì¼: HomeHealthCare-StatebyStateData.csv (ë²¤ì¹˜ë§ˆí¬ ë¹„êµìš©)

```sql
-- ğŸ“Š í˜„ì¬ í™œì„± ë§¤ì¹­ í˜„í™©
-- ì‚¬ìš© í…Œì´ë¸”: PersonalityBasedMatching (ë§¤ì¹­ ê²°ê³¼ ì €ì¥)
SELECT
    COUNT(*) as total_active,                                      -- í˜„ì¬ í™œì„± ë§¤ì¹­ ìˆ˜
    AVG(FinalScore) as avg_matching_score,                        -- í‰ê·  ìµœì¢… ì ìˆ˜
    AVG(PersonalityFitScore) as avg_personality_fit,              -- í‰ê·  ì„±í–¥ í˜¸í™˜ë„
    COUNT(CASE WHEN FinalScore >= 85 THEN 1 END) as excellent_count,  -- ìš°ìˆ˜(85~100)
    COUNT(CASE WHEN FinalScore >= 75 THEN 1 END) as good_count,       -- ì–‘í˜¸(75~84)
    COUNT(CASE WHEN FinalScore < 75 THEN 1 END) as fair_count         -- ë³´í†µ(<75)
FROM PersonalityBasedMatching
WHERE Status = 'Active';

-- ğŸ“Š Care Levelë³„ í‰ê·  ì ìˆ˜
-- ì‚¬ìš© í…Œì´ë¸”: PersonalityBasedMatching, Patients (ë˜ëŠ” Residents.csv)
-- ğŸ’¡ Care Levelë³„(ê²½ì¦, ì¤‘ì¦, ì¤‘ë„)ë¡œ ë§¤ì¹­ í’ˆì§ˆ ë¹„êµ
SELECT
    p.CareLevel,                                  -- í™˜ìì˜ ëŒë´„ ìˆ˜ì¤€
    COUNT(*) as matching_count,                  -- í•´ë‹¹ ìˆ˜ì¤€ì˜ ë§¤ì¹­ ìˆ˜
    AVG(pbm.FinalScore) as avg_score,            -- í‰ê·  ìµœì¢… ì ìˆ˜
    AVG(pbm.PersonalityFitScore) as avg_personality_fit,  -- í‰ê·  ì„±í–¥ í˜¸í™˜ë„
    AVG(pbm.PatientSatisfaction) as avg_satisfaction     -- í‰ê·  í™˜ì ë§Œì¡±ë„
FROM PersonalityBasedMatching pbm
JOIN Patients p ON pbm.PatientID = p.PatientID
WHERE pbm.Status = 'Active'
GROUP BY p.CareLevel
ORDER BY avg_score DESC;

-- ğŸ“Š ê°„ë³‘ì¸ ì§ê¸‰ë³„ ì„±ê³¼
-- ì‚¬ìš© í…Œì´ë¸”: PersonalityBasedMatching, Caregivers (ë˜ëŠ” staff.csv)
-- ğŸ’¡ ê°„ë³‘ì¸ì˜ ì§ê¸‰(ìš”ì–‘ë³´í˜¸ì‚¬, ê°„í˜¸ì‚¬ ë“±)ë³„ë¡œ ì„±ê³¼ ë¶„ì„
SELECT
    c.JobTitle,                                  -- ê°„ë³‘ì¸ì˜ ì§ê¸‰
    COUNT(*) as matching_count,                  -- í•´ë‹¹ ì§ê¸‰ì˜ ë§¤ì¹­ ìˆ˜
    AVG(pbm.FinalScore) as avg_score,            -- í‰ê·  ìµœì¢… ì ìˆ˜
    AVG(pbm.PersonalityFitScore) as avg_personality_fit,  -- í‰ê·  ì„±í–¥ í˜¸í™˜ë„
    AVG(c.AverageRating) as avg_caregiver_rating         -- í‰ê·  ë¦¬ë·° í‰ì 
FROM PersonalityBasedMatching pbm
JOIN Caregivers c ON pbm.CaregiverID = c.CaregiverID
WHERE pbm.Status = 'Active'
GROUP BY c.JobTitle
ORDER BY avg_score DESC;
```

---

## ë°ì´í„° í™œìš© ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: ì´ˆê¸° ë°ì´í„° ë¡œë“œ (1ì£¼)
- [ ] CAREHOME CSV íŒŒì¼ ì •ì œ ë° DB ë¡œë“œ
- [ ] Healthcare Dataset ë³‘í•©
- [ ] Home Health Care ë²¤ì¹˜ë§ˆí¬ ë°ì´í„° ë¡œë“œ
- [ ] ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ì™„ë£Œ
- [ ] ì´ìƒì¹˜ íƒì§€ ì™„ë£Œ

### Phase 2: ì„±í–¥ ì‹œìŠ¤í…œ êµ¬ì¶• (1ì£¼)
- [ ] ì„±í–¥ í…ŒìŠ¤íŠ¸ ë¬¸í•­ ì„¤ê³„ ì™„ë£Œ
- [ ] ì ìˆ˜ ê³„ì‚° ì—”ì§„ êµ¬í˜„
- [ ] PatientPersonality í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ìƒì„±
- [ ] ì„±í–¥ ë¶„ë¥˜ ë¡œì§ êµ¬í˜„
- [ ] AI ì„¤ëª… ìƒì„± í”„ë¡¬í”„íŠ¸ ì™„ì„±

### Phase 3: ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ (2ì£¼)
- [ ] ê°„ë³‘ì¸ ëŒë´„ ìŠ¤íƒ€ì¼ ë¶„ì„ ì—”ì§„ êµ¬í˜„
- [ ] CaregiverStyle í…Œì´ë¸” ë°ì´í„° ì±„ìš°ê¸°
- [ ] ì„±í–¥ í˜¸í™˜ë„ ê³„ì‚° ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„
- [ ] PersonalityBasedMatching í…Œì´ë¸” êµ¬ì¶•
- [ ] ìµœì¢… ë§¤ì¹­ ì ìˆ˜ ê³„ì‚° ë° ê²€ì¦

### Phase 4: UI ì—°ë™ (2ì£¼)
- [ ] ì„±í–¥ í…ŒìŠ¤íŠ¸ API êµ¬í˜„
- [ ] ê°„ë³‘ì¸ íƒìƒ‰ API êµ¬í˜„
- [ ] ìƒì„¸ í”„ë¡œí•„ API êµ¬í˜„
- [ ] ë¦¬í¬íŠ¸ ìƒì„± API êµ¬í˜„
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ í…ŒìŠ¤íŠ¸

### Phase 5: ëª¨ë‹ˆí„°ë§ & ìµœì í™” (ì§€ì†)
- [ ] ë§¤ì¹­ ì„±ê³µë¥  ëª¨ë‹ˆí„°ë§
- [ ] ì„±í–¥ ì˜ˆì¸¡ ì •í™•ë„ ê²€ì¦
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘
- [ ] ì•Œê³ ë¦¬ì¦˜ ê°€ì¤‘ì¹˜ ì¡°ì •
- [ ] ì„±ê³¼ ëŒ€ì‹œë³´ë“œ ìœ ì§€

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2024ë…„ 11ì›” 5ì¼
**ë²„ì „**: 1.0
